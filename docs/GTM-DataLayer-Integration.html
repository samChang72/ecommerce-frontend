<!DOCTYPE html>
<html>
<head>
<title>GTM-DataLayer-Integration.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="gtm-data-layer-%E6%95%B4%E5%90%88%E8%AA%AA%E6%98%8E%E6%96%87%E4%BB%B6">GTM Data Layer æ•´åˆèªªæ˜æ–‡ä»¶</h1>
<h2 id="%F0%9F%93%8B-%E6%A6%82%E8%BF%B0">ğŸ“‹ æ¦‚è¿°</h2>
<p>æœ¬æ–‡ä»¶èªªæ˜å¦‚ä½•åœ¨ Vue.js é›»å•†ç¶²ç«™ä¸­æ•´åˆ Google Tag Manager (GTM) çš„ Data Layerï¼Œä»¥è¿½è¹¤ä½¿ç”¨è€…çš„è³¼ç‰©è¡Œç‚ºï¼ŒåŒ…æ‹¬åŠ å…¥è³¼ç‰©è»Šã€ç§»é™¤å•†å“ã€æŸ¥çœ‹å•†å“å’Œé–‹å§‹çµå¸³ç­‰äº‹ä»¶ã€‚</p>
<h2 id="%F0%9F%94%84-%E8%B3%87%E6%96%99%E6%B5%81%E7%A8%8B">ğŸ”„ è³‡æ–™æµç¨‹</h2>
<pre class="hljs"><code><div>ä½¿ç”¨è€…æ“ä½œ â†’ Vue.js äº‹ä»¶è™•ç† â†’ Data Layer æ¨é€ â†’ GTM æ¥æ”¶ â†’ ç¬¬ä¸‰æ–¹è¿½è¹¤å·¥å…· (Facebook Pixel, OneAD Pixel ç­‰)
</div></code></pre>
<h2 id="%F0%9F%93%8A-data-layer-%E8%B3%87%E6%96%99%E7%B5%90%E6%A7%8B">ğŸ“Š Data Layer è³‡æ–™çµæ§‹</h2>
<h3 id="%E6%A8%99%E6%BA%96%E9%9B%BB%E5%95%86%E4%BA%8B%E4%BB%B6%E6%A0%BC%E5%BC%8F-%E7%AC%A6%E5%90%88-ga4-%E8%A6%8F%E7%AF%84">æ¨™æº–é›»å•†äº‹ä»¶æ ¼å¼ (ç¬¦åˆ GA4 è¦ç¯„)</h3>
<pre class="hljs"><code><div><span class="hljs-built_in">window</span>.dataLayer.push({
  <span class="hljs-attr">event</span>: <span class="hljs-string">'add_to_cart'</span>,
  <span class="hljs-attr">ecommerce</span>: {
    <span class="hljs-attr">currency</span>: <span class="hljs-string">'USD'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-number">30.00</span>,
    <span class="hljs-attr">items</span>: [{
      <span class="hljs-attr">item_id</span>: <span class="hljs-string">'1'</span>,
      <span class="hljs-attr">item_name</span>: <span class="hljs-string">'å¯æ¨‚'</span>,
      <span class="hljs-attr">category</span>: <span class="hljs-string">'é£²æ–™'</span>,
      <span class="hljs-attr">price</span>: <span class="hljs-number">30.00</span>,
      <span class="hljs-attr">quantity</span>: <span class="hljs-number">1</span>
    }]
  }
})
</div></code></pre>
<h2 id="%F0%9F%92%BB-%E7%A8%8B%E5%BC%8F%E5%AF%A6%E4%BD%9C%E7%AF%84%E4%BE%8B">ğŸ’» ç¨‹å¼å¯¦ä½œç¯„ä¾‹</h2>
<h3 id="1-%E9%A6%96%E9%A0%81---%E5%8A%A0%E5%85%A5%E8%B3%BC%E7%89%A9%E8%BB%8A-homepagevue">1. é¦–é  - åŠ å…¥è³¼ç‰©è»Š (HomePage.vue)</h3>
<pre class="hljs"><code><div>&lt;template&gt;
  &lt;div class=&quot;homepage&quot;&gt;
    &lt;!-- ç”¢å“åˆ—è¡¨ --&gt;
    &lt;div class=&quot;products&quot;&gt;
      &lt;ul&gt;
        &lt;li v-for=&quot;product in filteredProducts&quot; :key=&quot;product.id&quot; class=&quot;product-item&quot;&gt;
          &lt;img :src=&quot;product.image&quot; :alt=&quot;product.name&quot; class=&quot;product-image&quot; /&gt;
          &lt;div class=&quot;product-info&quot;&gt;
            &lt;strong&gt;{{ product.name }}&lt;/strong&gt;
            &lt;p class=&quot;price&quot;&gt;åƒ¹æ ¼: ${{ product.price }}&lt;/p&gt;
          &lt;/div&gt;
          &lt;!-- åŠ å…¥è³¼ç‰©è»ŠæŒ‰éˆ• --&gt;
          &lt;button @click=&quot;addToCart(product)&quot; class=&quot;add-to-cart-btn&quot;&gt;
            åŠ å…¥è³¼ç‰©è»Š
          &lt;/button&gt;
        &lt;/li&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import { ref, computed } from 'vue'
import { useCartStore } from '../store/cart'
import productsData from '../assets/products.json'

export default {
  name: 'HomePage',
  setup() {
    const cartStore = useCartStore()
    
    // åŠ å…¥è³¼ç‰©è»ŠåŠŸèƒ½
    const addToCart = (product) =&gt; {
      // 1. æ›´æ–°è³¼ç‰©è»Šç‹€æ…‹
      cartStore.addToCart(product)
      
      // 2. ç™¼é€ GTM äº‹ä»¶åˆ° Data Layer
      if (typeof window !== 'undefined' &amp;&amp; window.dataLayer) {
        window.dataLayer.push({
          event: 'add_to_cart',
          ecommerce: {
            currency: 'USD',
            value: parseFloat(product.price),
            items: [{
              item_id: product.id.toString(),
              item_name: product.name,
              category: product.type,
              price: parseFloat(product.price),
              quantity: 1
            }]
          }
        })
        
        // 3. Debug æ—¥èªŒ
        console.log('GTM add_to_cart event sent:', {
          item_name: product.name,
          item_id: product.id,
          price: product.price,
          category: product.type
        })
      }
      
      // 4. ä½¿ç”¨è€…å›é¥‹
      alert(`${product.name} å·²åŠ å…¥è³¼ç‰©è»Šï¼`)
    }
    
    return {
      addToCart
      // ... å…¶ä»–è¿”å›å€¼
    }
  }
}
&lt;/script&gt;
</div></code></pre>
<h3 id="2-%E7%94%A2%E5%93%81%E9%A0%81%E9%9D%A2---%E6%9F%A5%E7%9C%8B%E5%95%86%E5%93%81%E8%88%87%E5%8A%A0%E5%85%A5%E8%B3%BC%E7%89%A9%E8%BB%8A-productpagevue">2. ç”¢å“é é¢ - æŸ¥çœ‹å•†å“èˆ‡åŠ å…¥è³¼ç‰©è»Š (ProductPage.vue)</h3>
<pre class="hljs"><code><div>&lt;script&gt;
import { computed, onMounted } from 'vue'
import { useRoute, useRouter } from 'vue-router'
import { useCartStore } from '../store/cart'
import productsData from '../assets/products.json'

export default {
  name: 'ProductPage',
  setup() {
    const route = useRoute()
    const cartStore = useCartStore()
    
    const product = computed(() =&gt; {
      const productId = parseInt(route.params.id)
      return productsData.find(p =&gt; p.id === productId)
    })
    
    // ç•¶é é¢è¼‰å…¥æ™‚ç™¼é€æŸ¥çœ‹å•†å“äº‹ä»¶
    onMounted(() =&gt; {
      if (product.value &amp;&amp; typeof window !== 'undefined' &amp;&amp; window.dataLayer) {
        window.dataLayer.push({
          event: 'view_item',
          ecommerce: {
            currency: 'USD',
            value: parseFloat(product.value.price),
            items: [{
              item_id: product.value.id.toString(),
              item_name: product.value.name,
              category: product.value.type,
              price: parseFloat(product.value.price),
              quantity: 1
            }]
          }
        })
        
        console.log('GTM view_item event sent:', {
          item_name: product.value.name,
          item_id: product.value.id,
          price: product.value.price
        })
      }
    })
    
    // åŠ å…¥è³¼ç‰©è»Š
    const handleAddToCart = () =&gt; {
      if (product.value) {
        cartStore.addToCart(product.value)
        
        // ç™¼é€ GTM äº‹ä»¶
        if (typeof window !== 'undefined' &amp;&amp; window.dataLayer) {
          window.dataLayer.push({
            event: 'add_to_cart',
            ecommerce: {
              currency: 'USD',
              value: parseFloat(product.value.price),
              items: [{
                item_id: product.value.id.toString(),
                item_name: product.value.name,
                category: product.value.type,
                price: parseFloat(product.value.price),
                quantity: 1
              }]
            }
          })
          
          console.log('GTM add_to_cart event sent from ProductPage')
        }
        
        alert(`${product.value.name} å·²åŠ å…¥è³¼ç‰©è»Šï¼`)
      }
    }
    
    return {
      product,
      handleAddToCart
    }
  }
}
&lt;/script&gt;
</div></code></pre>
<h3 id="3-%E8%B3%BC%E7%89%A9%E8%BB%8A%E9%A0%81%E9%9D%A2---%E7%A7%BB%E9%99%A4%E5%95%86%E5%93%81%E8%88%87%E9%96%8B%E5%A7%8B%E7%B5%90%E5%B8%B3-cartpagevue">3. è³¼ç‰©è»Šé é¢ - ç§»é™¤å•†å“èˆ‡é–‹å§‹çµå¸³ (CartPage.vue)</h3>
<pre class="hljs"><code><div>&lt;script setup&gt;
import { computed } from 'vue'
import { useRouter } from 'vue-router'
import { useCartStore } from '../store/cart.js'

const router = useRouter()
const cartStore = useCartStore()
const { items } = cartStore

// ç§»é™¤è³¼ç‰©è»Šå•†å“
const removeFromCart = (itemId) =&gt; {
  const itemToRemove = items.find(item =&gt; item.id === itemId)
  
  if (itemToRemove) {
    // ç™¼é€ GTM äº‹ä»¶ - ç§»é™¤å•†å“
    if (typeof window !== 'undefined' &amp;&amp; window.dataLayer) {
      window.dataLayer.push({
        event: 'remove_from_cart',
        ecommerce: {
          currency: 'USD',
          value: parseFloat(itemToRemove.price) * itemToRemove.qty,
          items: [{
            item_id: itemToRemove.id.toString(),
            item_name: itemToRemove.name,
            category: itemToRemove.type,
            price: parseFloat(itemToRemove.price),
            quantity: itemToRemove.qty
          }]
        }
      })
      
      console.log('GTM remove_from_cart event sent:', {
        item_name: itemToRemove.name,
        item_id: itemToRemove.id,
        quantity: itemToRemove.qty
      })
    }
    
    // åŸ·è¡Œç§»é™¤æ“ä½œ
    cartStore.removeFromCart(itemId)
  }
}

// é–‹å§‹çµå¸³
const goToCheckout = () =&gt; {
  // ç™¼é€ GTM äº‹ä»¶ - é–‹å§‹çµå¸³
  if (typeof window !== 'undefined' &amp;&amp; window.dataLayer) {
    window.dataLayer.push({
      event: 'begin_checkout',
      ecommerce: {
        currency: 'USD',
        value: parseFloat(totalPrice.value),
        items: items.map(item =&gt; ({
          item_id: item.id.toString(),
          item_name: item.name,
          category: item.type,
          price: parseFloat(item.price),
          quantity: item.qty
        }))
      }
    })
    
    console.log('GTM begin_checkout event sent:', {
      total_value: totalPrice.value,
      item_count: items.length
    })
  }
  
  // å°å‘çµå¸³é é¢
  router.push('/checkout')
}

const totalPrice = computed(() =&gt; {
  return items.reduce((total, item) =&gt; total + (item.price * item.qty), 0)
})
&lt;/script&gt;
</div></code></pre>
<h3 id="4-%E8%B7%AF%E7%94%B1%E8%BF%BD%E8%B9%A4---%E9%A0%81%E9%9D%A2%E7%80%8F%E8%A6%BD%E4%BA%8B%E4%BB%B6-routerindexjs">4. è·¯ç”±è¿½è¹¤ - é é¢ç€è¦½äº‹ä»¶ (router/index.js)</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> { createRouter, createWebHashHistory } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>
<span class="hljs-comment">// ... è·¯ç”±é…ç½®</span>

<span class="hljs-keyword">const</span> router = createRouter({
  <span class="hljs-attr">history</span>: createWebHashHistory(),
  <span class="hljs-attr">routes</span>: [
    <span class="hljs-comment">// ... è·¯ç”±å®šç¾©</span>
  ]
})

<span class="hljs-comment">// GTM é é¢è¿½è¹¤</span>
router.afterEach(<span class="hljs-function">(<span class="hljs-params">to</span>) =&gt;</span> {
  <span class="hljs-comment">// ç¢ºä¿ GTM dataLayer å­˜åœ¨</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-built_in">window</span>.dataLayer) {
    <span class="hljs-comment">// ç™¼é€é é¢ç€è¦½äº‹ä»¶åˆ° GTM</span>
    <span class="hljs-built_in">window</span>.dataLayer.push({
      <span class="hljs-attr">event</span>: <span class="hljs-string">'page_view'</span>,
      <span class="hljs-attr">page_title</span>: to.meta?.title || <span class="hljs-built_in">document</span>.title,
      <span class="hljs-attr">page_location</span>: <span class="hljs-built_in">window</span>.location.href,
      <span class="hljs-attr">page_path</span>: to.path
    })
    
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'GTM page_view event sent:'</span>, {
      <span class="hljs-attr">page_path</span>: to.path,
      <span class="hljs-attr">page_title</span>: to.meta?.title || <span class="hljs-built_in">document</span>.title
    })
  }
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router
</div></code></pre>
<h3 id="5-%E7%B5%90%E5%B8%B3%E9%A0%81%E9%9D%A2---%E5%AE%8C%E6%88%90%E8%B3%BC%E8%B2%B7-checkoutpagevue">5. çµå¸³é é¢ - å®Œæˆè³¼è²· (CheckoutPage.vue)</h3>
<pre class="hljs"><code><div>&lt;script&gt;
import { ref, computed } from 'vue'
import { useRouter } from 'vue-router'
import { useCartStore } from '../store/cart'

export default {
  name: 'CheckoutPage',
  setup() {
    const router = useRouter()
    const cartStore = useCartStore()
    const { items, clearCart } = cartStore
    
    const formData = ref({
      name: '',
      address: '',
      phone: ''
    })
    
    const totalPrice = computed(() =&gt; {
      return items.reduce((total, item) =&gt; total + (item.price * item.qty), 0)
    })
    
    // æäº¤è¨‚å–®ä¸¦ç™¼é€ Purchase äº‹ä»¶
    const submitOrder = async () =&gt; {
      try {
        // ç”Ÿæˆå”¯ä¸€è¨‚å–®ç·¨è™Ÿ
        const transactionId = 'ORDER_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9)
        
        // ç™¼é€ GTM Purchase äº‹ä»¶
        if (typeof window !== 'undefined' &amp;&amp; window.dataLayer) {
          window.dataLayer.push({
            event: 'purchase',
            ecommerce: {
              transaction_id: transactionId,
              currency: 'USD',
              value: parseFloat(totalPrice.value),
              items: items.map(item =&gt; ({
                item_id: item.id.toString(),
                item_name: item.name,
                category: item.type,
                price: parseFloat(item.price),
                quantity: item.qty
              }))
            },
            // é¡å¤–çš„è¨‚å–®è³‡è¨Š
            customer_info: {
              name: formData.value.name,
              phone: formData.value.phone
            }
          })
          
          console.log('GTM purchase event sent:', {
            transaction_id: transactionId,
            total_value: totalPrice.value,
            item_count: items.length,
            customer_name: formData.value.name
          })
        }
        
        // æ¨¡æ“¬ API èª¿ç”¨
        await new Promise(resolve =&gt; setTimeout(resolve, 1500))
        
        // æ¸…ç©ºè³¼ç‰©è»Š
        clearCart()
        
        // å°å‘æˆåŠŸé é¢
        router.push('/order-success')
        
      } catch (error) {
        console.error('è¨‚å–®æäº¤å¤±æ•—:', error)
      }
    }
    
    return {
      formData,
      totalPrice,
      submitOrder,
      items
    }
  }
}
&lt;/script&gt;
</div></code></pre>
<h3 id="6-%E7%99%BB%E5%85%A5%E8%A8%BB%E5%86%8A%E9%A0%81%E9%9D%A2---%E7%94%A8%E6%88%B6%E8%A8%BB%E5%86%8A%E8%BF%BD%E8%B9%A4-loginpagevue">6. ç™»å…¥/è¨»å†Šé é¢ - ç”¨æˆ¶è¨»å†Šè¿½è¹¤ (LoginPage.vue)</h3>
<pre class="hljs"><code><div>&lt;script&gt;
import { ref, computed } from 'vue'
import { useRouter, useRoute } from 'vue-router'
import { useUserStore } from '../store/user'

export default {
  name: 'LoginPage',
  setup() {
    const router = useRouter()
    const route = useRoute()
    const userStore = useUserStore()
    
    const usernameInput = ref('')
    const isLoading = ref(false)
    const isNewUser = ref(false) // è¿½è¹¤æ˜¯å¦ç‚ºæ–°ç”¨æˆ¶
    
    // è™•ç†ç™»å…¥/è¨»å†Š
    const handleLogin = async () =&gt; {
      if (!canSubmit.value) return
      
      isLoading.value = true
      
      // æª¢æŸ¥æ˜¯å¦ç‚ºæ–°ç”¨æˆ¶ï¼ˆæ¨¡æ“¬æª¢æŸ¥é‚è¼¯ï¼‰
      const isFirstTimeLogin = !localStorage.getItem(`user_${usernameInput.value}_visited`)
      
      setTimeout(() =&gt; {
        const result = userStore.login(usernameInput.value)
        
        if (result.success) {
          // å¦‚æœæ˜¯æ–°ç”¨æˆ¶ï¼Œç™¼é€è¨»å†Šå®Œæˆäº‹ä»¶
          if (isFirstTimeLogin) {
            // æ¨™è¨˜ç”¨æˆ¶å·²è¨ªå•
            localStorage.setItem(`user_${usernameInput.value}_visited`, 'true')
            
            // ç™¼é€ GTM è¨»å†Šäº‹ä»¶
            if (typeof window !== 'undefined' &amp;&amp; window.dataLayer) {
              window.dataLayer.push({
                event: 'sign_up',
                user_data: {
                  username: usernameInput.value,
                  registration_method: 'website',
                  registration_type: 'manual',
                  is_first_time: true
                },
                // å¯é¸ï¼šå¦‚æœæœ‰è¨»å†Šçå‹µ
                ecommerce: {
                  currency: 'USD',
                  value: 0, // è¨»å†Šçå‹µé‡‘é¡
                  items: [] // å¦‚æœæœ‰è´ˆé€å•†å“
                }
              })
              
              console.log('GTM sign_up event sent:', {
                username: usernameInput.value,
                registration_method: 'website',
                timestamp: new Date().toISOString()
              })
            }
            
            isNewUser.value = true
          } else {
            // ç¾æœ‰ç”¨æˆ¶ç™»å…¥ï¼Œç™¼é€ç™»å…¥äº‹ä»¶
            if (typeof window !== 'undefined' &amp;&amp; window.dataLayer) {
              window.dataLayer.push({
                event: 'login',
                user_data: {
                  username: usernameInput.value,
                  login_method: 'website',
                  is_returning_user: true
                }
              })
              
              console.log('GTM login event sent:', {
                username: usernameInput.value,
                login_method: 'website'
              })
            }
          }
          
          // ç™»å…¥æˆåŠŸå¾Œçš„å°å‘
          const redirectTo = route.query.redirect || '/'
          router.push(redirectTo)
        } else {
          errorMessage.value = result.message
        }
        
        isLoading.value = false
      }, 500)
    }
    
    return {
      usernameInput,
      isLoading,
      isNewUser,
      handleLogin
      // ... å…¶ä»–è¿”å›å€¼
    }
  }
}
&lt;/script&gt;
</div></code></pre>
<h2 id="%F0%9F%94%A7-gtm-%E8%A8%AD%E5%AE%9A%E6%8C%87%E5%8D%97">ğŸ”§ GTM è¨­å®šæŒ‡å—</h2>
<h3 id="gtm-%E8%AE%8A%E6%95%B8%E8%A8%AD%E5%AE%9A">GTM è®Šæ•¸è¨­å®š</h3>
<p>åœ¨ GTM å¾Œå°å»ºç«‹ä»¥ä¸‹è³‡æ–™å±¤è®Šæ•¸ (Data Layer Variable)ï¼š</p>
<h4 id="%E9%9B%BB%E5%95%86%E4%BA%8B%E4%BB%B6%E8%AE%8A%E6%95%B8">é›»å•†äº‹ä»¶è®Šæ•¸</h4>
<table>
<thead>
<tr>
<th>è®Šæ•¸åç¨±</th>
<th>è®Šæ•¸é¡å‹</th>
<th>è³‡æ–™å±¤è®Šæ•¸åç¨±</th>
<th>èªªæ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DLV - Item ID</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>ecommerce.items.0.item_id</code></td>
<td>å•†å“ ID</td>
</tr>
<tr>
<td><code>DLV - Item Name</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>ecommerce.items.0.item_name</code></td>
<td>å•†å“åç¨±</td>
</tr>
<tr>
<td><code>DLV - Item Price</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>ecommerce.items.0.price</code></td>
<td>å•†å“åƒ¹æ ¼</td>
</tr>
<tr>
<td><code>DLV - Item Category</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>ecommerce.items.0.category</code></td>
<td>å•†å“é¡åˆ¥</td>
</tr>
<tr>
<td><code>DLV - Item Quantity</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>ecommerce.items.0.quantity</code></td>
<td>å•†å“æ•¸é‡</td>
</tr>
<tr>
<td><code>DLV - Ecommerce Value</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>ecommerce.value</code></td>
<td>äº¤æ˜“ç¸½å€¼</td>
</tr>
<tr>
<td><code>DLV - Currency</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>ecommerce.currency</code></td>
<td>å¹£åˆ¥</td>
</tr>
<tr>
<td><code>DLV - Transaction ID</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>ecommerce.transaction_id</code></td>
<td>äº¤æ˜“è¨‚å–®ç·¨è™Ÿ</td>
</tr>
<tr>
<td><code>DLV - Ecommerce Items</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>ecommerce.items</code></td>
<td>è³¼ç‰©è»Šå•†å“é™£åˆ—</td>
</tr>
</tbody>
</table>
<h4 id="%E8%87%AA%E8%A8%82-javascript-%E8%AE%8A%E6%95%B8-%E9%9C%80%E8%A6%81%E5%85%88%E5%BB%BA%E7%AB%8B-dlv---ecommerce-items">è‡ªè¨‚ JavaScript è®Šæ•¸ (éœ€è¦å…ˆå»ºç«‹ DLV - Ecommerce Items)</h4>
<table>
<thead>
<tr>
<th>è®Šæ•¸åç¨±</th>
<th>è®Šæ•¸é¡å‹</th>
<th>JavaScript ä»£ç¢¼</th>
<th>èªªæ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DLV - Cart Items Count</code></td>
<td>è‡ªè¨‚ JavaScript</td>
<td><code>function(){var items={{DLV - Ecommerce Items}};return items?items.length:0;}</code></td>
<td>è³¼ç‰©è»Šå•†å“æ•¸é‡</td>
</tr>
<tr>
<td><code>DLV - Cart Item IDs</code></td>
<td>è‡ªè¨‚ JavaScript</td>
<td><code>function(){var items={{DLV - Ecommerce Items}};return items?items.map(function(item){return item.item_id;}):[]; }</code></td>
<td>è³¼ç‰©è»Šæ‰€æœ‰å•†å“ ID é™£åˆ—</td>
</tr>
</tbody>
</table>
<h4 id="%E7%94%A8%E6%88%B6%E4%BA%8B%E4%BB%B6%E8%AE%8A%E6%95%B8">ç”¨æˆ¶äº‹ä»¶è®Šæ•¸</h4>
<table>
<thead>
<tr>
<th>è®Šæ•¸åç¨±</th>
<th>è®Šæ•¸é¡å‹</th>
<th>è³‡æ–™å±¤è®Šæ•¸åç¨±</th>
<th>èªªæ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DLV - Username</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>user_data.username</code></td>
<td>ç”¨æˆ¶å</td>
</tr>
<tr>
<td><code>DLV - Registration Method</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>user_data.registration_method</code></td>
<td>è¨»å†Šæ–¹å¼ (website, social, email)</td>
</tr>
<tr>
<td><code>DLV - Registration Type</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>user_data.registration_type</code></td>
<td>è¨»å†Šé¡å‹ (manual, auto, invited)</td>
</tr>
<tr>
<td><code>DLV - User Registration Type</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>user_data.registration_method</code></td>
<td>ç”¨æ–¼ OneAD Pixel çš„è¨»å†Šé¡å‹</td>
</tr>
<tr>
<td><code>DLV - Registration Value</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>ecommerce.value</code></td>
<td>è¨»å†Šçå‹µåƒ¹å€¼</td>
</tr>
<tr>
<td><code>DLV - Is First Time</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>user_data.is_first_time</code></td>
<td>æ˜¯å¦ç‚ºé¦–æ¬¡è¨»å†Š</td>
</tr>
<tr>
<td><code>DLV - Login Method</code></td>
<td>è³‡æ–™å±¤è®Šæ•¸</td>
<td><code>user_data.login_method</code></td>
<td>ç™»å…¥æ–¹å¼</td>
</tr>
</tbody>
</table>
<h3 id="gtm-%E8%A7%B8%E7%99%BC%E6%A2%9D%E4%BB%B6%E8%A8%AD%E5%AE%9A">GTM è§¸ç™¼æ¢ä»¶è¨­å®š</h3>
<p>å»ºç«‹ä»¥ä¸‹è‡ªè¨‚äº‹ä»¶è§¸ç™¼æ¢ä»¶ï¼š</p>
<h4 id="%E9%9B%BB%E5%95%86%E4%BA%8B%E4%BB%B6%E8%A7%B8%E7%99%BC%E6%A2%9D%E4%BB%B6">é›»å•†äº‹ä»¶è§¸ç™¼æ¢ä»¶</h4>
<table>
<thead>
<tr>
<th>è§¸ç™¼æ¢ä»¶åç¨±</th>
<th>è§¸ç™¼æ¢ä»¶é¡å‹</th>
<th>æ¢ä»¶è¨­å®š</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Trigger - Add to Cart</code></td>
<td>è‡ªè¨‚äº‹ä»¶</td>
<td>äº‹ä»¶åç¨±ç­‰æ–¼ <code>add_to_cart</code></td>
</tr>
<tr>
<td><code>Trigger - Remove from Cart</code></td>
<td>è‡ªè¨‚äº‹ä»¶</td>
<td>äº‹ä»¶åç¨±ç­‰æ–¼ <code>remove_from_cart</code></td>
</tr>
<tr>
<td><code>Trigger - View Item</code></td>
<td>è‡ªè¨‚äº‹ä»¶</td>
<td>äº‹ä»¶åç¨±ç­‰æ–¼ <code>view_item</code></td>
</tr>
<tr>
<td><code>Trigger - Begin Checkout</code></td>
<td>è‡ªè¨‚äº‹ä»¶</td>
<td>äº‹ä»¶åç¨±ç­‰æ–¼ <code>begin_checkout</code></td>
</tr>
<tr>
<td><code>Trigger - Purchase</code></td>
<td>è‡ªè¨‚äº‹ä»¶</td>
<td>äº‹ä»¶åç¨±ç­‰æ–¼ <code>purchase</code></td>
</tr>
<tr>
<td><code>Trigger - Page View</code></td>
<td>è‡ªè¨‚äº‹ä»¶</td>
<td>äº‹ä»¶åç¨±ç­‰æ–¼ <code>page_view</code></td>
</tr>
</tbody>
</table>
<h4 id="%E7%94%A8%E6%88%B6%E4%BA%8B%E4%BB%B6%E8%A7%B8%E7%99%BC%E6%A2%9D%E4%BB%B6">ç”¨æˆ¶äº‹ä»¶è§¸ç™¼æ¢ä»¶</h4>
<table>
<thead>
<tr>
<th>è§¸ç™¼æ¢ä»¶åç¨±</th>
<th>è§¸ç™¼æ¢ä»¶é¡å‹</th>
<th>æ¢ä»¶è¨­å®š</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Trigger - Sign Up</code></td>
<td>è‡ªè¨‚äº‹ä»¶</td>
<td>äº‹ä»¶åç¨±ç­‰æ–¼ <code>sign_up</code></td>
</tr>
<tr>
<td><code>Trigger - Login</code></td>
<td>è‡ªè¨‚äº‹ä»¶</td>
<td>äº‹ä»¶åç¨±ç­‰æ–¼ <code>login</code></td>
</tr>
<tr>
<td><code>Trigger - First Time Registration</code></td>
<td>è‡ªè¨‚äº‹ä»¶</td>
<td>äº‹ä»¶åç¨±ç­‰æ–¼ <code>sign_up</code> AND <code>{{DLV - Is First Time}}</code> ç­‰æ–¼ <code>true</code></td>
</tr>
</tbody>
</table>
<h3 id="onead-pixel-%E6%95%B4%E5%90%88">OneAD Pixel æ•´åˆ</h3>
<p>OneAD Pixel ä¹Ÿæ”¯æ´é›»å•†äº‹ä»¶è¿½è¹¤ï¼Œä»¥ä¸‹æ˜¯å°ç…§è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th>GTM Event</th>
<th>OneAD Pixel Event</th>
<th>åƒæ•¸æ ¼å¼</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>add_to_cart</code></td>
<td><code>AddToCart</code></td>
<td><code>{ content_ids, content_name, content_category, value, currency }</code></td>
</tr>
<tr>
<td><code>view_item</code></td>
<td><code>ViewContent</code></td>
<td><code>{ content_ids, content_name, content_category, content_type }</code></td>
</tr>
<tr>
<td><code>begin_checkout</code></td>
<td><code>InitiateCheckout</code></td>
<td><code>{ value, currency, num_items, content_ids }</code></td>
</tr>
<tr>
<td><code>purchase</code></td>
<td><code>Purchase</code></td>
<td><code>{ content_ids, value, currency, transaction_id, num_items }</code></td>
</tr>
<tr>
<td><code>sign_up</code></td>
<td><code>CompleteRegistration</code></td>
<td><code>{ status, content_name }</code></td>
</tr>
</tbody>
</table>
<h4 id="onead-pixel-%E4%BB%A3%E7%A2%BC%E7%AF%84%E4%BE%8B">OneAD Pixel ä»£ç¢¼ç¯„ä¾‹ï¼š</h4>
<pre class="hljs"><code><div><span class="hljs-comment">&lt;!-- AddToCart äº‹ä»¶ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript">
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> onep !== <span class="hljs-string">'undefined'</span>) {
  onep(<span class="hljs-string">'track'</span>, <span class="hljs-string">'AddToCart'</span>, {
    content_ids: [<span class="hljs-string">'{{DLV - Item ID}}'</span>],
    content_name: <span class="hljs-string">'{{DLV - Item Name}}'</span>,
    content_category: <span class="hljs-string">'{{DLV - Item Category}}'</span>,
    content_type: <span class="hljs-string">'product'</span>,
    value: {{DLV - Item Price}},
    currency: <span class="hljs-string">'USD'</span>
  });
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-comment">&lt;!-- ViewContent äº‹ä»¶ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript">
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> onep !== <span class="hljs-string">'undefined'</span>) {
  onep(<span class="hljs-string">'track'</span>, <span class="hljs-string">'ViewContent'</span>, {
    content_ids: [<span class="hljs-string">'{{DLV - Item ID}}'</span>],
    content_name: <span class="hljs-string">'{{DLV - Item Name}}'</span>,
    content_category: <span class="hljs-string">'{{DLV - Item Category}}'</span>,
    content_type: <span class="hljs-string">'product'</span>
  });
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-comment">&lt;!-- InitiateCheckout äº‹ä»¶ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript">
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> onep !== <span class="hljs-string">'undefined'</span>) {
  onep(<span class="hljs-string">'track'</span>, <span class="hljs-string">'InitiateCheckout'</span>, {
    content_ids: {{DLV - Cart Item IDs}}, <span class="hljs-comment">// é™£åˆ—æ ¼å¼: ['1', '2', '3']</span>
    value: {{DLV - Ecommerce Value}},
    currency: <span class="hljs-string">'USD'</span>,
    num_items: {{DLV - Cart Items Count}}
  });
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-comment">&lt;!-- Purchase äº‹ä»¶ (å®Œæˆè³¼è²·) --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> onep !== <span class="hljs-string">'undefined'</span>) {
  onep(<span class="hljs-string">'track'</span>, <span class="hljs-string">'Purchase'</span>, {
    <span class="hljs-attr">content_ids</span>: {{DLV - Cart Item IDs}}, <span class="hljs-comment">// æ‰€æœ‰è³¼è²·å•†å“çš„ ID é™£åˆ—</span>
    <span class="hljs-attr">value</span>: {{DLV - Ecommerce Value}},     <span class="hljs-comment">// äº¤æ˜“ç¸½é‡‘é¡</span>
    <span class="hljs-attr">currency</span>: <span class="hljs-string">'USD'</span>,                      <span class="hljs-comment">// å¹£åˆ¥</span>
    <span class="hljs-attr">transaction_id</span>: <span class="hljs-string">'{{DLV - Transaction ID}}'</span>, <span class="hljs-comment">// è¨‚å–®ç·¨è™Ÿ</span>
    <span class="hljs-attr">num_items</span>: {{DLV - Cart Items Count}} <span class="hljs-comment">// è³¼è²·å•†å“ç¸½æ•¸</span>
  });
  
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'OneAD Pixel Purchase fired:'</span>, {
    <span class="hljs-attr">transaction_id</span>: <span class="hljs-string">'{{DLV - Transaction ID}}'</span>,
    <span class="hljs-attr">value</span>: {{DLV - Ecommerce Value}},
    <span class="hljs-attr">num_items</span>: {{DLV - Cart Items Count}}
  });
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-comment">&lt;!-- CompleteRegistration äº‹ä»¶ (è¨»å†Šå®Œæˆ) --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> onep !== <span class="hljs-string">'undefined'</span>) {
  onep(<span class="hljs-string">'track'</span>, <span class="hljs-string">'CompleteRegistration'</span>, {
    <span class="hljs-attr">status</span>: <span class="hljs-string">'success'</span>,                        <span class="hljs-comment">// è¨»å†Šç‹€æ…‹</span>
    <span class="hljs-attr">content_name</span>: <span class="hljs-string">'{{DLV - User Registration Type}}'</span>, <span class="hljs-comment">// è¨»å†Šé¡å‹ (å¦‚ï¼š'website', 'email', 'social')</span>
    <span class="hljs-comment">// å¯é¸åƒæ•¸</span>
    <span class="hljs-attr">currency</span>: <span class="hljs-string">'USD'</span>,                          <span class="hljs-comment">// å¦‚æœæœ‰è¨»å†Šçå‹µé‡‘é¡</span>
    <span class="hljs-attr">value</span>: {{DLV - Registration Value}}       <span class="hljs-comment">// è¨»å†Šçå‹µåƒ¹å€¼</span>
  });
  
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'OneAD Pixel CompleteRegistration fired:'</span>, {
    <span class="hljs-attr">username</span>: <span class="hljs-string">'{{DLV - Username}}'</span>,
    <span class="hljs-attr">registration_type</span>: <span class="hljs-string">'{{DLV - User Registration Type}}'</span>,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString()
  });
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</div></code></pre>
<h3 id="facebook-pixel-%E4%BA%8B%E4%BB%B6%E5%B0%8D%E7%85%A7%E8%A1%A8">Facebook Pixel äº‹ä»¶å°ç…§è¡¨</h3>
<p>æœ¬è¡¨æ ¼æ•´ç†äº† GTM Data Layer äº‹ä»¶èˆ‡ Facebook Pixel æ¨™æº–äº‹ä»¶çš„å°æ‡‰é—œä¿‚ï¼š</p>
<table>
<thead>
<tr>
<th>GTM Event</th>
<th>Facebook Pixel Event</th>
<th>èªªæ˜</th>
<th>è§¸ç™¼æ™‚æ©Ÿ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>add_to_cart</code></td>
<td><code>AddToCart</code></td>
<td>åŠ å…¥è³¼ç‰©è»Š</td>
<td>ä½¿ç”¨è€…é»æ“Šã€ŒåŠ å…¥è³¼ç‰©è»Šã€æŒ‰éˆ•</td>
</tr>
<tr>
<td><code>remove_from_cart</code></td>
<td><em>(è‡ªè¨‚äº‹ä»¶)</em></td>
<td>ç§»é™¤è³¼ç‰©è»Š</td>
<td>ä½¿ç”¨è€…åœ¨è³¼ç‰©è»Šé é¢ç§»é™¤å•†å“</td>
</tr>
<tr>
<td><code>view_item</code></td>
<td><code>ViewContent</code></td>
<td>æŸ¥çœ‹å…§å®¹</td>
<td>ä½¿ç”¨è€…é€²å…¥ç”¢å“è©³ç´°é é¢</td>
</tr>
<tr>
<td><code>begin_checkout</code></td>
<td><code>InitiateCheckout</code></td>
<td>é–‹å§‹çµå¸³</td>
<td>ä½¿ç”¨è€…é»æ“Šã€Œçµå¸³ã€æŒ‰éˆ•</td>
</tr>
<tr>
<td><code>purchase</code></td>
<td><code>Purchase</code></td>
<td>å®Œæˆè³¼è²·</td>
<td>ä½¿ç”¨è€…å®Œæˆè¨‚å–®æäº¤</td>
</tr>
<tr>
<td><code>sign_up</code></td>
<td><code>CompleteRegistration</code></td>
<td>å®Œæˆè¨»å†Š</td>
<td>ä½¿ç”¨è€…å®Œæˆå¸³è™Ÿè¨»å†Š</td>
</tr>
<tr>
<td><code>login</code></td>
<td><em>(è‡ªè¨‚äº‹ä»¶)</em></td>
<td>ç”¨æˆ¶ç™»å…¥</td>
<td>ä½¿ç”¨è€…ç™»å…¥å¸³è™Ÿ</td>
</tr>
<tr>
<td><code>page_view</code></td>
<td><code>PageView</code></td>
<td>é é¢ç€è¦½</td>
<td>è‡ªå‹•è¿½è¹¤é é¢è¼‰å…¥</td>
</tr>
</tbody>
</table>
<h3 id="facebook-pixel-%E5%8F%83%E6%95%B8%E5%B0%8D%E7%85%A7%E8%A1%A8">Facebook Pixel åƒæ•¸å°ç…§è¡¨</h3>
<h4 id="%E9%9B%BB%E5%95%86%E4%BA%8B%E4%BB%B6%E5%8F%83%E6%95%B8">é›»å•†äº‹ä»¶åƒæ•¸</h4>
<table>
<thead>
<tr>
<th>åƒæ•¸ç”¨é€”</th>
<th>GTM è®Šæ•¸</th>
<th>Facebook Pixel åƒæ•¸</th>
<th>è³‡æ–™é¡å‹</th>
<th>ç¯„ä¾‹å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>å•†å“ ID</td>
<td><code>{{DLV - Item ID}}</code></td>
<td><code>content_ids</code></td>
<td>Array</td>
<td><code>['1']</code></td>
</tr>
<tr>
<td>å•†å“åç¨±</td>
<td><code>{{DLV - Item Name}}</code></td>
<td><code>content_name</code></td>
<td>String</td>
<td><code>'å¯æ¨‚'</code></td>
</tr>
<tr>
<td>å•†å“é¡åˆ¥</td>
<td><code>{{DLV - Item Category}}</code></td>
<td><code>content_category</code></td>
<td>String</td>
<td><code>'é£²æ–™'</code></td>
</tr>
<tr>
<td>å•†å“åƒ¹æ ¼</td>
<td><code>{{DLV - Item Price}}</code></td>
<td><code>value</code></td>
<td>Number</td>
<td><code>30.00</code></td>
</tr>
<tr>
<td>å¹£åˆ¥</td>
<td><code>'USD'</code></td>
<td><code>currency</code></td>
<td>String</td>
<td><code>'USD'</code></td>
</tr>
<tr>
<td>å…§å®¹é¡å‹</td>
<td><code>'product'</code></td>
<td><code>content_type</code></td>
<td>String</td>
<td><code>'product'</code></td>
</tr>
<tr>
<td>æ•¸é‡</td>
<td><code>{{DLV - Item Quantity}}</code></td>
<td><code>num_items</code></td>
<td>Number</td>
<td><code>1</code></td>
</tr>
</tbody>
</table>
<h4 id="%E7%94%A8%E6%88%B6%E4%BA%8B%E4%BB%B6%E5%8F%83%E6%95%B8">ç”¨æˆ¶äº‹ä»¶åƒæ•¸</h4>
<table>
<thead>
<tr>
<th>åƒæ•¸ç”¨é€”</th>
<th>GTM è®Šæ•¸</th>
<th>Facebook Pixel åƒæ•¸</th>
<th>è³‡æ–™é¡å‹</th>
<th>ç¯„ä¾‹å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>è¨»å†Šæ–¹å¼</td>
<td><code>{{DLV - Registration Method}}</code></td>
<td><code>content_name</code></td>
<td>String</td>
<td><code>'website'</code></td>
</tr>
<tr>
<td>è¨»å†Šç‹€æ…‹</td>
<td><code>'success'</code></td>
<td><code>status</code></td>
<td>String</td>
<td><code>'success'</code></td>
</tr>
<tr>
<td>è¨»å†Šçå‹µå€¼</td>
<td><code>{{DLV - Registration Value}}</code></td>
<td><code>value</code></td>
<td>Number</td>
<td><code>0</code></td>
</tr>
<tr>
<td>å¹£åˆ¥</td>
<td><code>'USD'</code></td>
<td><code>currency</code></td>
<td>String</td>
<td><code>'USD'</code></td>
</tr>
</tbody>
</table>
<h3 id="%E7%AC%AC%E4%B8%89%E6%96%B9%E8%BF%BD%E8%B9%A4%E4%BB%A3%E7%A2%BC%E7%AF%84%E4%BE%8B">ç¬¬ä¸‰æ–¹è¿½è¹¤ä»£ç¢¼ç¯„ä¾‹</h3>
<h4 id="1-addtocart-%E4%BA%8B%E4%BB%B6-%E5%8A%A0%E5%85%A5%E8%B3%BC%E7%89%A9%E8%BB%8A">1. AddToCart äº‹ä»¶ (åŠ å…¥è³¼ç‰©è»Š)</h4>
<pre class="hljs"><code><div><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript">
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fbq !== <span class="hljs-string">'undefined'</span>) {
  fbq(<span class="hljs-string">'track'</span>, <span class="hljs-string">'AddToCart'</span>, {
    content_ids: [<span class="hljs-string">'{{DLV - Item ID}}'</span>],
    content_name: <span class="hljs-string">'{{DLV - Item Name}}'</span>,
    content_category: <span class="hljs-string">'{{DLV - Item Category}}'</span>,
    content_type: <span class="hljs-string">'product'</span>,
    value: {{DLV - Item Price}},
    currency: <span class="hljs-string">'USD'</span>,
    num_items: <span class="hljs-number">1</span>
  });
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</div></code></pre>
<h4 id="2-viewcontent-%E4%BA%8B%E4%BB%B6-%E6%9F%A5%E7%9C%8B%E5%95%86%E5%93%81">2. ViewContent äº‹ä»¶ (æŸ¥çœ‹å•†å“)</h4>
<pre class="hljs"><code><div><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript">
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fbq !== <span class="hljs-string">'undefined'</span>) {
  fbq(<span class="hljs-string">'track'</span>, <span class="hljs-string">'ViewContent'</span>, {
    content_ids: [<span class="hljs-string">'{{DLV - Item ID}}'</span>],
    content_name: <span class="hljs-string">'{{DLV - Item Name}}'</span>,
    content_category: <span class="hljs-string">'{{DLV - Item Category}}'</span>,
    content_type: <span class="hljs-string">'product'</span>,
    value: {{DLV - Item Price}},
    currency: <span class="hljs-string">'USD'</span>
  });
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</div></code></pre>
<h4 id="3-initiatecheckout-%E4%BA%8B%E4%BB%B6-%E9%96%8B%E5%A7%8B%E7%B5%90%E5%B8%B3">3. InitiateCheckout äº‹ä»¶ (é–‹å§‹çµå¸³)</h4>
<pre class="hljs"><code><div><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript">
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fbq !== <span class="hljs-string">'undefined'</span>) {
  fbq(<span class="hljs-string">'track'</span>, <span class="hljs-string">'InitiateCheckout'</span>, {
    content_ids: {{DLV - Cart Item IDs}}, <span class="hljs-comment">// é™£åˆ—æ ¼å¼: ['1', '2', '3']</span>
    value: {{DLV - Ecommerce Value}},
    currency: <span class="hljs-string">'USD'</span>,
    num_items: {{DLV - Cart Items Count}}
  });
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</div></code></pre>
<h4 id="4-purchase-%E4%BA%8B%E4%BB%B6-%E5%AE%8C%E6%88%90%E8%B3%BC%E8%B2%B7">4. Purchase äº‹ä»¶ (å®Œæˆè³¼è²·)</h4>
<pre class="hljs"><code><div><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fbq !== <span class="hljs-string">'undefined'</span>) {
  fbq(<span class="hljs-string">'track'</span>, <span class="hljs-string">'Purchase'</span>, {
    <span class="hljs-attr">content_ids</span>: {{DLV - Cart Item IDs}}, <span class="hljs-comment">// æ‰€æœ‰è³¼è²·å•†å“çš„ ID é™£åˆ—</span>
    <span class="hljs-attr">value</span>: {{DLV - Ecommerce Value}},     <span class="hljs-comment">// äº¤æ˜“ç¸½é‡‘é¡</span>
    <span class="hljs-attr">currency</span>: <span class="hljs-string">'USD'</span>,                      <span class="hljs-comment">// å¹£åˆ¥</span>
    <span class="hljs-attr">content_type</span>: <span class="hljs-string">'product'</span>,              <span class="hljs-comment">// å…§å®¹é¡å‹</span>
    <span class="hljs-attr">num_items</span>: {{DLV - Cart Items Count}}, <span class="hljs-comment">// è³¼è²·å•†å“ç¸½æ•¸</span>
    <span class="hljs-comment">// å¯é¸åƒæ•¸</span>
    <span class="hljs-attr">order_id</span>: <span class="hljs-string">'{{DLV - Transaction ID}}'</span>  <span class="hljs-comment">// è¨‚å–®ç·¨è™Ÿ</span>
  });
  
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Facebook Pixel Purchase fired:'</span>, {
    <span class="hljs-attr">transaction_id</span>: <span class="hljs-string">'{{DLV - Transaction ID}}'</span>,
    <span class="hljs-attr">value</span>: {{DLV - Ecommerce Value}},
    <span class="hljs-attr">num_items</span>: {{DLV - Cart Items Count}}
  });
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</div></code></pre>
<h4 id="5-completeregistration-%E4%BA%8B%E4%BB%B6-%E5%AE%8C%E6%88%90%E8%A8%BB%E5%86%8A">5. CompleteRegistration äº‹ä»¶ (å®Œæˆè¨»å†Š)</h4>
<pre class="hljs"><code><div><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fbq !== <span class="hljs-string">'undefined'</span>) {
  fbq(<span class="hljs-string">'track'</span>, <span class="hljs-string">'CompleteRegistration'</span>, {
    <span class="hljs-attr">content_name</span>: <span class="hljs-string">'{{DLV - Registration Method}}'</span>, <span class="hljs-comment">// è¨»å†Šæ–¹å¼</span>
    <span class="hljs-attr">status</span>: <span class="hljs-string">'success'</span>,                             <span class="hljs-comment">// è¨»å†Šç‹€æ…‹</span>
    <span class="hljs-attr">value</span>: {{DLV - Registration Value}},           <span class="hljs-comment">// è¨»å†Šçå‹µåƒ¹å€¼ (å¦‚æœæœ‰)</span>
    <span class="hljs-attr">currency</span>: <span class="hljs-string">'USD'</span>                                <span class="hljs-comment">// å¹£åˆ¥</span>
  });
  
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Facebook Pixel CompleteRegistration fired:'</span>, {
    <span class="hljs-attr">username</span>: <span class="hljs-string">'{{DLV - Username}}'</span>,
    <span class="hljs-attr">registration_method</span>: <span class="hljs-string">'{{DLV - Registration Method}}'</span>,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString()
  });
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</div></code></pre>
<h4 id="6-%E8%87%AA%E8%A8%82%E7%99%BB%E5%85%A5%E4%BA%8B%E4%BB%B6">6. è‡ªè¨‚ç™»å…¥äº‹ä»¶</h4>
<pre class="hljs"><code><div><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fbq !== <span class="hljs-string">'undefined'</span>) {
  fbq(<span class="hljs-string">'trackCustom'</span>, <span class="hljs-string">'UserLogin'</span>, {
    <span class="hljs-attr">content_name</span>: <span class="hljs-string">'{{DLV - Login Method}}'</span>,        <span class="hljs-comment">// ç™»å…¥æ–¹å¼</span>
    <span class="hljs-attr">status</span>: <span class="hljs-string">'success'</span>                              <span class="hljs-comment">// ç™»å…¥ç‹€æ…‹</span>
  });
  
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Facebook Pixel UserLogin fired:'</span>, {
    <span class="hljs-attr">username</span>: <span class="hljs-string">'{{DLV - Username}}'</span>,
    <span class="hljs-attr">login_method</span>: <span class="hljs-string">'{{DLV - Login Method}}'</span>
  });
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</div></code></pre>
<h4 id="7-%E8%87%AA%E8%A8%82%E7%A7%BB%E9%99%A4%E8%B3%BC%E7%89%A9%E8%BB%8A%E4%BA%8B%E4%BB%B6">7. è‡ªè¨‚ç§»é™¤è³¼ç‰©è»Šäº‹ä»¶</h4>
<pre class="hljs"><code><div><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript">
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fbq !== <span class="hljs-string">'undefined'</span>) {
  fbq(<span class="hljs-string">'trackCustom'</span>, <span class="hljs-string">'RemoveFromCart'</span>, {
    content_ids: [<span class="hljs-string">'{{DLV - Item ID}}'</span>],
    content_name: <span class="hljs-string">'{{DLV - Item Name}}'</span>,
    content_category: <span class="hljs-string">'{{DLV - Item Category}}'</span>,
    content_type: <span class="hljs-string">'product'</span>,
    value: {{DLV - Item Price}},
    currency: <span class="hljs-string">'USD'</span>
  });
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</div></code></pre>
<h2 id="%F0%9F%A7%AA-%E6%B8%AC%E8%A9%A6%E8%88%87%E9%99%A4%E9%8C%AF">ğŸ§ª æ¸¬è©¦èˆ‡é™¤éŒ¯</h2>
<h3 id="1-%E7%80%8F%E8%A6%BD%E5%99%A8%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%B8%AC%E8%A9%A6">1. ç€è¦½å™¨æ§åˆ¶å°æ¸¬è©¦</h3>
<h4 id="%E6%AA%A2%E6%9F%A5-datalayer-%E7%8B%80%E6%85%8B">æª¢æŸ¥ DataLayer ç‹€æ…‹</h4>
<pre class="hljs"><code><div><span class="hljs-comment">// æª¢æŸ¥ dataLayer æ˜¯å¦å­˜åœ¨</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'DataLayer exists:'</span>, <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.dataLayer !== <span class="hljs-string">'undefined'</span>);

<span class="hljs-comment">// æŸ¥çœ‹æ‰€æœ‰ dataLayer äº‹ä»¶</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'DataLayer contents:'</span>, <span class="hljs-built_in">window</span>.dataLayer);

<span class="hljs-comment">// éæ¿¾ç‰¹å®šäº‹ä»¶</span>
<span class="hljs-built_in">window</span>.dataLayer.filter(<span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> event.event === <span class="hljs-string">'add_to_cart'</span>);
</div></code></pre>
<h4 id="%E6%89%8B%E5%8B%95%E6%B8%AC%E8%A9%A6%E4%BA%8B%E4%BB%B6%E6%8E%A8%E9%80%81">æ‰‹å‹•æ¸¬è©¦äº‹ä»¶æ¨é€</h4>
<pre class="hljs"><code><div><span class="hljs-comment">// æ¸¬è©¦åŠ å…¥è³¼ç‰©è»Šäº‹ä»¶</span>
<span class="hljs-built_in">window</span>.dataLayer.push({
  <span class="hljs-attr">event</span>: <span class="hljs-string">'add_to_cart'</span>,
  <span class="hljs-attr">ecommerce</span>: {
    <span class="hljs-attr">currency</span>: <span class="hljs-string">'USD'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-number">30.00</span>,
    <span class="hljs-attr">items</span>: [{
      <span class="hljs-attr">item_id</span>: <span class="hljs-string">'1'</span>,
      <span class="hljs-attr">item_name</span>: <span class="hljs-string">'Test Product'</span>,
      <span class="hljs-attr">category</span>: <span class="hljs-string">'Test Category'</span>,
      <span class="hljs-attr">price</span>: <span class="hljs-number">30.00</span>,
      <span class="hljs-attr">quantity</span>: <span class="hljs-number">1</span>
    }]
  }
});

<span class="hljs-comment">// æ¸¬è©¦ç”¨æˆ¶è¨»å†Šäº‹ä»¶</span>
<span class="hljs-built_in">window</span>.dataLayer.push({
  <span class="hljs-attr">event</span>: <span class="hljs-string">'sign_up'</span>,
  <span class="hljs-attr">user_data</span>: {
    <span class="hljs-attr">username</span>: <span class="hljs-string">'testuser123'</span>,
    <span class="hljs-attr">registration_method</span>: <span class="hljs-string">'website'</span>,
    <span class="hljs-attr">registration_type</span>: <span class="hljs-string">'manual'</span>,
    <span class="hljs-attr">is_first_time</span>: <span class="hljs-literal">true</span>
  },
  <span class="hljs-attr">ecommerce</span>: {
    <span class="hljs-attr">currency</span>: <span class="hljs-string">'USD'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// è¨»å†Šçå‹µé‡‘é¡</span>
    <span class="hljs-attr">items</span>: []
  }
});

<span class="hljs-comment">// æ¸¬è©¦ç”¨æˆ¶ç™»å…¥äº‹ä»¶</span>
<span class="hljs-built_in">window</span>.dataLayer.push({
  <span class="hljs-attr">event</span>: <span class="hljs-string">'login'</span>,
  <span class="hljs-attr">user_data</span>: {
    <span class="hljs-attr">username</span>: <span class="hljs-string">'existinguser456'</span>,
    <span class="hljs-attr">login_method</span>: <span class="hljs-string">'website'</span>,
    <span class="hljs-attr">is_returning_user</span>: <span class="hljs-literal">true</span>
  }
});

<span class="hljs-comment">// é©—è­‰äº‹ä»¶æ˜¯å¦æ¨é€æˆåŠŸ</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Last event:'</span>, <span class="hljs-built_in">window</span>.dataLayer[<span class="hljs-built_in">window</span>.dataLayer.length - <span class="hljs-number">1</span>]);
</div></code></pre>
<h3 id="2-gtm-preview-%E6%A8%A1%E5%BC%8F%E6%B8%AC%E8%A9%A6%E6%B5%81%E7%A8%8B">2. GTM Preview æ¨¡å¼æ¸¬è©¦æµç¨‹</h3>
<h4 id="%E6%AD%A5%E9%A9%9F-1-%E5%95%9F%E7%94%A8-preview-%E6%A8%A1%E5%BC%8F">æ­¥é©Ÿ 1: å•Ÿç”¨ Preview æ¨¡å¼</h4>
<ol>
<li>ç™»å…¥ GTM å¾Œå°</li>
<li>é»æ“Šå³ä¸Šè§’ã€Œé è¦½ã€æŒ‰éˆ•</li>
<li>è¼¸å…¥ç¶²ç«™ URL é–‹å§‹é™¤éŒ¯</li>
</ol>
<h4 id="%E6%AD%A5%E9%A9%9F-2-%E6%B8%AC%E8%A9%A6%E4%BA%8B%E4%BB%B6%E8%A7%B8%E7%99%BC">æ­¥é©Ÿ 2: æ¸¬è©¦äº‹ä»¶è§¸ç™¼</h4>
<table>
<thead>
<tr>
<th>æ¸¬è©¦é …ç›®</th>
<th>åŸ·è¡Œå‹•ä½œ</th>
<th>é æœŸçµæœ</th>
</tr>
</thead>
<tbody>
<tr>
<td>é é¢è¼‰å…¥</td>
<td>é‡æ–°æ•´ç†é é¢</td>
<td>è§¸ç™¼ <code>page_view</code> äº‹ä»¶</td>
</tr>
<tr>
<td>å•†å“ç€è¦½</td>
<td>é»æ“Šå•†å“é€²å…¥è©³ç´°é </td>
<td>è§¸ç™¼ <code>view_item</code> äº‹ä»¶</td>
</tr>
<tr>
<td>åŠ å…¥è³¼ç‰©è»Š</td>
<td>é»æ“Šã€ŒåŠ å…¥è³¼ç‰©è»Šã€æŒ‰éˆ•</td>
<td>è§¸ç™¼ <code>add_to_cart</code> äº‹ä»¶</td>
</tr>
<tr>
<td>ç§»é™¤å•†å“</td>
<td>åœ¨è³¼ç‰©è»Šé é¢ç§»é™¤å•†å“</td>
<td>è§¸ç™¼ <code>remove_from_cart</code> äº‹ä»¶</td>
</tr>
<tr>
<td>é–‹å§‹çµå¸³</td>
<td>é»æ“Šã€Œçµå¸³ã€æŒ‰éˆ•</td>
<td>è§¸ç™¼ <code>begin_checkout</code> äº‹ä»¶</td>
</tr>
<tr>
<td>å®Œæˆè³¼è²·</td>
<td>åœ¨çµå¸³é é¢æäº¤è¨‚å–®</td>
<td>è§¸ç™¼ <code>purchase</code> äº‹ä»¶</td>
</tr>
<tr>
<td>ç”¨æˆ¶è¨»å†Š</td>
<td>é¦–æ¬¡ç™»å…¥æ–°å¸³è™Ÿ</td>
<td>è§¸ç™¼ <code>sign_up</code> äº‹ä»¶</td>
</tr>
<tr>
<td>ç”¨æˆ¶ç™»å…¥</td>
<td>ç¾æœ‰ç”¨æˆ¶ç™»å…¥</td>
<td>è§¸ç™¼ <code>login</code> äº‹ä»¶</td>
</tr>
</tbody>
</table>
<h4 id="%E6%AD%A5%E9%A9%9F-3-%E9%A9%97%E8%AD%89%E8%AE%8A%E6%95%B8%E5%80%BC">æ­¥é©Ÿ 3: é©—è­‰è®Šæ•¸å€¼</h4>
<p>åœ¨ GTM Preview ä¸­æª¢æŸ¥ä»¥ä¸‹è®Šæ•¸æ˜¯å¦æ­£ç¢ºå–å€¼ï¼š</p>
<ul>
<li><code>{{DLV - Item ID}}</code> - æ‡‰é¡¯ç¤ºå•†å“ ID</li>
<li><code>{{DLV - Item Name}}</code> - æ‡‰é¡¯ç¤ºå•†å“åç¨±</li>
<li><code>{{DLV - Item Price}}</code> - æ‡‰é¡¯ç¤ºæ­£ç¢ºåƒ¹æ ¼</li>
<li><code>{{DLV - Ecommerce Value}}</code> - æ‡‰é¡¯ç¤ºäº¤æ˜“ç¸½å€¼</li>
</ul>
<h3 id="3-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B7%A5%E5%85%B7%E9%A9%97%E8%AD%89">3. ç¬¬ä¸‰æ–¹å·¥å…·é©—è­‰</h3>
<h4 id="onead-pixel-%E6%B8%AC%E8%A9%A6">OneAD Pixel æ¸¬è©¦</h4>
<ol>
<li>å®‰è£ <a href="https://chromewebstore.google.com/detail/onead-tag-assistant/giclcphmgfdppppohhbfccocanhbdijd?utm_source=ext_app_menu">OneAD Pixel Helper</a> ç€è¦½å™¨æ“´å……åŠŸèƒ½</li>
<li>åŸ·è¡Œè³¼ç‰©æ“ä½œä¸¦è§€å¯Ÿ Pixel Helper ç‹€æ…‹</li>
</ol>
<h3 id="4-%E9%96%8B%E7%99%BC%E8%80%85%E5%B7%A5%E5%85%B7-network-%E6%AA%A2%E6%9F%A5">4. é–‹ç™¼è€…å·¥å…· Network æª¢æŸ¥</h3>
<h4 id="%E6%AA%A2%E6%9F%A5%E8%BF%BD%E8%B9%A4%E8%AB%8B%E6%B1%82">æª¢æŸ¥è¿½è¹¤è«‹æ±‚</h4>
<p>OneAD ç›¸é—œç¶²åŸŸ</p>
<ul>
<li>https://onead.onevision.com.tw/</li>
<li>https://pixel.onead.com.tw/</li>
</ul>
<h3 id="5-%E5%B8%B8%E8%A6%8B%E5%95%8F%E9%A1%8C%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4">5. å¸¸è¦‹å•é¡Œæ•…éšœæ’é™¤</h3>
<h3 id="5-%E5%B8%B8%E8%A6%8B%E5%95%8F%E9%A1%8C%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4">5. å¸¸è¦‹å•é¡Œæ•…éšœæ’é™¤</h3>
<h4 id="%F0%9F%93%8B-gtm-%E8%AE%8A%E6%95%B8%E8%A8%AD%E5%AE%9A%E6%AD%A5%E9%A9%9F%E6%8C%87%E5%8D%97">ğŸ“‹ <strong>GTM è®Šæ•¸è¨­å®šæ­¥é©ŸæŒ‡å—</strong></h4>
<p><strong>æ­¥é©Ÿ 1: å»ºç«‹åŸºç¤è³‡æ–™å±¤è®Šæ•¸</strong></p>
<pre class="hljs"><code><div>è®Šæ•¸ â†’ æ–°å¢ â†’ é¸æ“‡ã€Œè³‡æ–™å±¤è®Šæ•¸ã€
- è®Šæ•¸åç¨±: DLV - Ecommerce Items
- è³‡æ–™å±¤è®Šæ•¸åç¨±: ecommerce.items
- å„²å­˜
</div></code></pre>
<p><strong>æ­¥é©Ÿ 2: å»ºç«‹è‡ªè¨‚ JavaScript è®Šæ•¸</strong></p>
<pre class="hljs"><code><div>è®Šæ•¸ â†’ æ–°å¢ â†’ é¸æ“‡ã€Œè‡ªè¨‚ JavaScriptã€
- è®Šæ•¸åç¨±: DLV - Cart Items Count
- è‡ªè¨‚ JavaScript:
function(){
  var items = {{DLV - Ecommerce Items}};
  return items ? items.length : 0;
}
- å„²å­˜
</div></code></pre>
<pre class="hljs"><code><div>è®Šæ•¸ â†’ æ–°å¢ â†’ é¸æ“‡ã€Œè‡ªè¨‚ JavaScriptã€
- è®Šæ•¸åç¨±: DLV - Cart Item IDs
- è‡ªè¨‚ JavaScript:
function(){
  var items = {{DLV - Ecommerce Items}};
  return items ? items.map(function(item){
    return item.item_id;
  }) : [];
}
- å„²å­˜
</div></code></pre>
<h4 id="q-%E8%AE%8A%E6%95%B8%E8%A8%AD%E5%AE%9A%E9%8C%AF%E8%AA%A4%E6%AA%A2%E6%9F%A5%E6%B8%85%E5%96%AE">Q: è®Šæ•¸è¨­å®šéŒ¯èª¤æª¢æŸ¥æ¸…å–®</h4>
<p><strong>å¿…é ˆæŒ‰é †åºå»ºç«‹çš„è®Šæ•¸ï¼š</strong></p>
<ol>
<li>
<p><strong>åŸºç¤è³‡æ–™å±¤è®Šæ•¸</strong> (å…ˆå»ºç«‹é€™äº›)</p>
<ul>
<li>âœ… <code>DLV - Ecommerce Items</code> â†’ <code>ecommerce.items</code></li>
<li>âœ… <code>DLV - Ecommerce Value</code> â†’ <code>ecommerce.value</code></li>
<li>âœ… <code>DLV - Transaction ID</code> â†’ <code>ecommerce.transaction_id</code></li>
</ul>
</li>
<li>
<p><strong>ä¾è³´è®Šæ•¸</strong> (éœ€è¦å…ˆæœ‰åŸºç¤è®Šæ•¸)</p>
<ul>
<li>âœ… <code>DLV - Cart Items Count</code> â†’ è‡ªè¨‚ JS (ä¾è³´ DLV - Ecommerce Items)</li>
<li>âœ… <code>DLV - Cart Item IDs</code> â†’ è‡ªè¨‚ JS (ä¾è³´ DLV - Ecommerce Items)</li>
</ul>
</li>
</ol>
<p><strong>å¸¸è¦‹éŒ¯èª¤ä¿®æ­£ï¼š</strong></p>
<ul>
<li>âŒ <code>{{ecommerce.items}}</code> â†’ âœ… <code>{{DLV - Ecommerce Items}}</code></li>
<li>âŒ <code>DLV - Transaction Value</code> â†’ âœ… <code>DLV - Ecommerce Value</code></li>
<li>âŒ <code>[{{DLV - Cart Item IDs}}]</code> â†’ âœ… <code>{{DLV - Cart Item IDs}}</code></li>
</ul>
<h4 id="q-datalayer-%E4%BA%8B%E4%BB%B6%E6%B2%92%E6%9C%89%E8%A7%B8%E7%99%BC">Q: DataLayer äº‹ä»¶æ²’æœ‰è§¸ç™¼</h4>
<p><strong>å¯èƒ½åŸå› èˆ‡è§£æ±ºæ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>
<p><strong>Vue çµ„ä»¶ç”Ÿå‘½é€±æœŸå•é¡Œ</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// ç¢ºä¿åœ¨ DOM æ›´æ–°å¾Œè§¸ç™¼</span>
<span class="hljs-keyword">this</span>.$nextTick(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">window</span>.dataLayer.push({...});
});
</div></code></pre>
</li>
<li>
<p><strong>GTM ä»£ç¢¼è¼‰å…¥é †åº</strong></p>
<ul>
<li>ç¢ºèª GTM ä»£ç¢¼åœ¨ <code>&lt;head&gt;</code> ä¸­æ­£ç¢ºè¼‰å…¥</li>
<li>æª¢æŸ¥ noscript ç‰ˆæœ¬æ˜¯å¦åœ¨ <code>&lt;body&gt;</code> é–‹å§‹è™•</li>
</ul>
</li>
<li>
<p><strong>äº‹ä»¶åç¨±æ‹¼å¯«éŒ¯èª¤</strong></p>
<ul>
<li>ç¢ºèª Vue.js ä¸­çš„äº‹ä»¶åç¨±èˆ‡ GTM è§¸ç™¼æ¢ä»¶ä¸€è‡´</li>
</ul>
</li>
</ol>
<h4 id="q-%E8%AE%8A%E6%95%B8%E5%80%BC%E7%82%BA-undefined">Q: è®Šæ•¸å€¼ç‚º undefined</h4>
<p><strong>æª¢æŸ¥é …ç›®ï¼š</strong></p>
<ol>
<li>DataLayer æ¨é€çš„è³‡æ–™çµæ§‹æ˜¯å¦æ­£ç¢º</li>
<li>GTM è®Šæ•¸çš„è³‡æ–™å±¤è®Šæ•¸åç¨±æ˜¯å¦æº–ç¢º</li>
<li>äº‹ä»¶è§¸ç™¼æ™‚æ©Ÿæ˜¯å¦æ­£ç¢º</li>
</ol>
<h4 id="q-%E7%AC%AC%E4%B8%89%E6%96%B9-pixel-%E6%B2%92%E6%9C%89%E6%8E%A5%E6%94%B6%E5%88%B0%E4%BA%8B%E4%BB%B6">Q: ç¬¬ä¸‰æ–¹ Pixel æ²’æœ‰æ¥æ”¶åˆ°äº‹ä»¶</h4>
<p><strong>æ•…éšœæ’é™¤æ­¥é©Ÿï¼š</strong></p>
<ol>
<li>æª¢æŸ¥ GTM ä»£ç¢¼æ˜¯å¦æ­£ç¢ºç™¼å¸ƒ</li>
<li>ç¢ºèªè§¸ç™¼æ¢ä»¶æ˜¯å¦ç¬¦åˆ</li>
<li>æª¢æŸ¥ç€è¦½å™¨å»£å‘Šæ””æˆªå™¨è¨­å®š</li>
<li>é©—è­‰ç¬¬ä¸‰æ–¹ Pixel ä»£ç¢¼èªæ³•</li>
</ol>
<h3 id="6-%E6%95%88%E8%83%BD%E7%9B%A3%E6%8E%A7">6. æ•ˆèƒ½ç›£æ§</h3>
<h4 id="datalayer-%E5%A4%A7%E5%B0%8F%E7%9B%A3%E6%8E%A7">DataLayer å¤§å°ç›£æ§</h4>
<pre class="hljs"><code><div><span class="hljs-comment">// æª¢æŸ¥ dataLayer å¤§å° (å»ºè­° &lt; 1MB)</span>
<span class="hljs-keyword">const</span> dataLayerSize = <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-built_in">window</span>.dataLayer).length;
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'DataLayer size (bytes):'</span>, dataLayerSize);

<span class="hljs-comment">// æ¸…ç†èˆŠäº‹ä»¶ (ä¿ç•™æœ€è¿‘ 100 å€‹)</span>
<span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.dataLayer.length &gt; <span class="hljs-number">100</span>) {
  <span class="hljs-built_in">window</span>.dataLayer.splice(<span class="hljs-number">0</span>, <span class="hljs-built_in">window</span>.dataLayer.length - <span class="hljs-number">100</span>);
}
</div></code></pre>
<h4 id="%E4%BA%8B%E4%BB%B6%E9%A0%BB%E7%8E%87%E7%9B%A3%E6%8E%A7">äº‹ä»¶é »ç‡ç›£æ§</h4>
<pre class="hljs"><code><div><span class="hljs-comment">// è¿½è¹¤äº‹ä»¶æ¨é€é »ç‡</span>
<span class="hljs-keyword">let</span> eventCount = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> originalPush = <span class="hljs-built_in">window</span>.dataLayer.push;
<span class="hljs-built_in">window</span>.dataLayer.push = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  eventCount++;
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Event #<span class="hljs-subst">${eventCount}</span>:`</span>, <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>]);
  <span class="hljs-keyword">return</span> originalPush.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
};
</div></code></pre>
<h2 id="%F0%9F%93%9D-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85%E8%88%87%E6%9C%80%E4%BD%B3%E5%AF%A6%E5%8B%99">ğŸ“ æ³¨æ„äº‹é …èˆ‡æœ€ä½³å¯¦å‹™</h2>
<h3 id="%F0%9F%94%92-%E8%B3%87%E6%96%99%E5%90%88%E8%A6%8F%E8%88%87%E9%9A%B1%E7%A7%81">ğŸ”’ è³‡æ–™åˆè¦èˆ‡éš±ç§</h3>
<ol>
<li>
<p><strong>GDPR / CCPA åˆè¦</strong></p>
<ul>
<li>åœ¨æ­ç›Ÿæˆ–åŠ å·ä½¿ç”¨è€…è¨ªå•å‰ï¼Œéœ€å–å¾—è¿½è¹¤åŒæ„</li>
<li>å¯¦ä½œ Consent Management Platform (CMP)</li>
<li>æä¾›è³‡æ–™ä½¿ç”¨é€æ˜åº¦èªªæ˜</li>
</ul>
</li>
<li>
<p><strong>è³‡æ–™æœ€å°åŒ–åŸå‰‡</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// âŒ é¿å…å‚³é€æ•æ„Ÿè³‡æ–™</span>
<span class="hljs-built_in">window</span>.dataLayer.push({
  <span class="hljs-attr">event</span>: <span class="hljs-string">'add_to_cart'</span>,
  <span class="hljs-attr">user_email</span>: <span class="hljs-string">'user@example.com'</span>, <span class="hljs-comment">// ä¸è¦å‚³é€ PII</span>
  <span class="hljs-attr">user_phone</span>: <span class="hljs-string">'+1234567890'</span>        <span class="hljs-comment">// ä¸è¦å‚³é€ PII</span>
});

<span class="hljs-comment">// âœ… åªå‚³é€å¿…è¦çš„å•†æ¥­è³‡æ–™</span>
<span class="hljs-built_in">window</span>.dataLayer.push({
  <span class="hljs-attr">event</span>: <span class="hljs-string">'add_to_cart'</span>,
  <span class="hljs-attr">ecommerce</span>: {
    <span class="hljs-attr">currency</span>: <span class="hljs-string">'USD'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-number">30.00</span>,
    <span class="hljs-attr">items</span>: [{ <span class="hljs-comment">/* å•†å“è³‡æ–™ */</span> }]
  }
});
</div></code></pre>
</li>
</ol>
<h3 id="%E2%9A%A1-%E6%95%88%E8%83%BD%E5%84%AA%E5%8C%96">âš¡ æ•ˆèƒ½å„ªåŒ–</h3>
<ol>
<li>
<p><strong>è³‡æ–™å‹åˆ¥å„ªåŒ–</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// âœ… ç¢ºä¿æ•¸å€¼å‹åˆ¥æ­£ç¢º</span>
<span class="hljs-attr">price</span>: <span class="hljs-built_in">parseFloat</span>(product.price),        <span class="hljs-comment">// æ•¸å­—</span>
<span class="hljs-attr">item_id</span>: product.id.toString(),          <span class="hljs-comment">// å­—ä¸²</span>
<span class="hljs-attr">quantity</span>: <span class="hljs-built_in">parseInt</span>(item.qty)             <span class="hljs-comment">// æ•´æ•¸</span>
</div></code></pre>
</li>
<li>
<p><strong>äº‹ä»¶å»é‡æ©Ÿåˆ¶</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// é˜²æ­¢é‡è¤‡é»æ“Šé€ æˆå¤šæ¬¡äº‹ä»¶</span>
<span class="hljs-keyword">let</span> isEventSent = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">const</span> addToCart = <span class="hljs-function">(<span class="hljs-params">product</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (!isEventSent) {
    isEventSent = <span class="hljs-literal">true</span>;
    <span class="hljs-built_in">window</span>.dataLayer.push({...});
    
    <span class="hljs-comment">// 2ç§’å¾Œé‡ç½®ï¼Œå…è¨±ä¸‹æ¬¡æ“ä½œ</span>
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> { isEventSent = <span class="hljs-literal">false</span>; }, <span class="hljs-number">2000</span>);
  }
};
</div></code></pre>
</li>
<li>
<p><strong>æ¢ä»¶è¼‰å…¥</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// åªåœ¨å¿…è¦æ™‚è¼‰å…¥è¿½è¹¤ä»£ç¢¼</span>
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-built_in">window</span>.dataLayer) {
  <span class="hljs-built_in">window</span>.dataLayer.push({...});
}
</div></code></pre>
</li>
</ol>
<h3 id="%F0%9F%8F%97%EF%B8%8F-%E7%A8%8B%E5%BC%8F%E6%9E%B6%E6%A7%8B%E5%BB%BA%E8%AD%B0">ğŸ—ï¸ ç¨‹å¼æ¶æ§‹å»ºè­°</h3>
<ol>
<li>
<p><strong>çµ±ä¸€äº‹ä»¶ç®¡ç†</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// å»ºç«‹çµ±ä¸€çš„è¿½è¹¤ç®¡ç†é¡åˆ¥</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TrackingManager</span> </span>{
  <span class="hljs-keyword">static</span> trackEvent(eventName, eventData) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-built_in">window</span>.dataLayer) {
      <span class="hljs-built_in">window</span>.dataLayer.push({
        <span class="hljs-attr">event</span>: eventName,
        ...eventData
      });
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`[Tracking] <span class="hljs-subst">${eventName}</span>:`</span>, eventData);
    }
  }

  <span class="hljs-keyword">static</span> trackEcommerce(event, ecommerceData) {
    <span class="hljs-keyword">this</span>.trackEvent(event, { <span class="hljs-attr">ecommerce</span>: ecommerceData });
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¯„ä¾‹</span>
TrackingManager.trackEcommerce(<span class="hljs-string">'add_to_cart'</span>, {
  <span class="hljs-attr">currency</span>: <span class="hljs-string">'USD'</span>,
  <span class="hljs-attr">value</span>: <span class="hljs-number">30.00</span>,
  <span class="hljs-attr">items</span>: [{ <span class="hljs-comment">/* å•†å“è³‡æ–™ */</span> }]
});
</div></code></pre>
</li>
<li>
<p><strong>Vue.js Mixin æ¨¡å¼</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// tracking-mixin.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> trackingMixin = {
  <span class="hljs-attr">methods</span>: {
    $track(eventName, data) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-built_in">window</span>.dataLayer) {
        <span class="hljs-built_in">window</span>.dataLayer.push({
          <span class="hljs-attr">event</span>: eventName,
          <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
          ...data
        });
      }
    }
  }
};

<span class="hljs-comment">// åœ¨çµ„ä»¶ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">import</span> { trackingMixin } <span class="hljs-keyword">from</span> <span class="hljs-string">'./mixins/tracking-mixin'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">mixins</span>: [trackingMixin],
  <span class="hljs-attr">methods</span>: {
    addToCart(product) {
      <span class="hljs-keyword">this</span>.$track(<span class="hljs-string">'add_to_cart'</span>, {
        <span class="hljs-attr">ecommerce</span>: { <span class="hljs-comment">/* è³‡æ–™ */</span> }
      });
    }
  }
};
</div></code></pre>
</li>
</ol>
<h3 id="%F0%9F%9A%80-%E9%83%A8%E7%BD%B2%E8%88%87%E7%B6%AD%E8%AD%B7">ğŸš€ éƒ¨ç½²èˆ‡ç¶­è­·</h3>
<ol>
<li>
<p><strong>ç’°å¢ƒå€åˆ†</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// æ ¹æ“šç’°å¢ƒä½¿ç”¨ä¸åŒçš„ GTM å®¹å™¨</span>
<span class="hljs-keyword">const</span> GTM_ID = process.env.NODE_ENV === <span class="hljs-string">'production'</span> 
  ? <span class="hljs-string">'GTM-PROD-123'</span> 
  : <span class="hljs-string">'GTM-DEV-456'</span>;
</div></code></pre>
</li>
<li>
<p><strong>ç‰ˆæœ¬æ§åˆ¶</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// åœ¨äº‹ä»¶ä¸­åŠ å…¥ç‰ˆæœ¬è³‡è¨Š</span>
<span class="hljs-built_in">window</span>.dataLayer.push({
  <span class="hljs-attr">event</span>: <span class="hljs-string">'add_to_cart'</span>,
  <span class="hljs-attr">tracking_version</span>: <span class="hljs-string">'1.2.0'</span>,
  <span class="hljs-attr">ecommerce</span>: { <span class="hljs-comment">/* è³‡æ–™ */</span> }
});
</div></code></pre>
</li>
<li>
<p><strong>éŒ¯èª¤ç›£æ§</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// è¿½è¹¤éŒ¯èª¤åˆ° DataLayer</span>
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'error'</span>, (event) =&gt; {
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.dataLayer) {
    <span class="hljs-built_in">window</span>.dataLayer.push({
      <span class="hljs-attr">event</span>: <span class="hljs-string">'javascript_error'</span>,
      <span class="hljs-attr">error_message</span>: event.message,
      <span class="hljs-attr">error_filename</span>: event.filename,
      <span class="hljs-attr">error_lineno</span>: event.lineno
    });
  }
});
</div></code></pre>
</li>
</ol>
<h3 id="%F0%9F%93%8A-%E6%88%90%E6%95%88%E7%9B%A3%E6%8E%A7%E6%8C%87%E6%A8%99">ğŸ“Š æˆæ•ˆç›£æ§æŒ‡æ¨™</h3>
<h4 id="%E6%8A%80%E8%A1%93%E6%8C%87%E6%A8%99">æŠ€è¡“æŒ‡æ¨™</h4>
<ul>
<li><strong>äº‹ä»¶æˆåŠŸç‡</strong>: äº‹ä»¶è§¸ç™¼æ•¸ / ä½¿ç”¨è€…æ“ä½œæ•¸</li>
<li><strong>è³‡æ–™å®Œæ•´æ€§</strong>: åŒ…å«å¿…è¦åƒæ•¸çš„äº‹ä»¶ç™¾åˆ†æ¯”</li>
<li><strong>å»¶é²æ™‚é–“</strong>: å¾ä½¿ç”¨è€…æ“ä½œåˆ°äº‹ä»¶ç™¼é€çš„æ™‚é–“</li>
</ul>
<h4 id="%E6%A5%AD%E5%8B%99%E6%8C%87%E6%A8%99">æ¥­å‹™æŒ‡æ¨™</h4>
<ul>
<li><strong>è½‰æ›æ¼æ–—</strong>: PageView â†’ ViewContent â†’ AddToCart â†’ InitiateCheckout â†’ Purchase</li>
<li><strong>è³¼ç‰©è»Šæ”¾æ£„ç‡</strong>: (AddToCart - Purchase) / AddToCart</li>
<li><strong>å•†å“ç†±é–€åº¦</strong>: å„å•†å“çš„ ViewContent å’Œ AddToCart æ¬¡æ•¸</li>
</ul>
<h3 id="%F0%9F%94%84-%E6%8C%81%E7%BA%8C%E5%84%AA%E5%8C%96">ğŸ”„ æŒçºŒå„ªåŒ–</h3>
<ol>
<li>
<p><strong>A/B æ¸¬è©¦æ•´åˆ</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">window</span>.dataLayer.push({
  <span class="hljs-attr">event</span>: <span class="hljs-string">'add_to_cart'</span>,
  <span class="hljs-attr">ab_test_variant</span>: <span class="hljs-string">'checkout_button_v2'</span>,
  <span class="hljs-attr">ecommerce</span>: { <span class="hljs-comment">/* è³‡æ–™ */</span> }
});
</div></code></pre>
</li>
<li>
<p><strong>ä½¿ç”¨è€…æ—…ç¨‹è¿½è¹¤</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// è¨˜éŒ„ä½¿ç”¨è€…çš„å®Œæ•´è³¼ç‰©æ—…ç¨‹</span>
<span class="hljs-keyword">const</span> userJourney = {
  <span class="hljs-attr">session_id</span>: <span class="hljs-string">'unique_session_id'</span>,
  <span class="hljs-attr">user_segment</span>: <span class="hljs-string">'returning_customer'</span>,
  <span class="hljs-attr">traffic_source</span>: <span class="hljs-string">'google_ads'</span>
};

<span class="hljs-built_in">window</span>.dataLayer.push({
  <span class="hljs-attr">event</span>: <span class="hljs-string">'add_to_cart'</span>,
  <span class="hljs-attr">user_journey</span>: userJourney,
  <span class="hljs-attr">ecommerce</span>: { <span class="hljs-comment">/* è³‡æ–™ */</span> }
});
</div></code></pre>
</li>
</ol>
<h2 id="%F0%9F%94%97-%E7%9B%B8%E9%97%9C%E8%B3%87%E6%BA%90%E8%88%87%E6%96%87%E4%BB%B6">ğŸ”— ç›¸é—œè³‡æºèˆ‡æ–‡ä»¶</h2>
<h3 id="%E5%AE%98%E6%96%B9%E6%96%87%E4%BB%B6">å®˜æ–¹æ–‡ä»¶</h3>
<ul>
<li><strong><a href="https://developers.google.com/tag-manager">Google Tag Manager é–‹ç™¼è€…æŒ‡å—</a></strong></li>
<li><strong><a href="https://developers.google.com/analytics/devguides/collection/ga4/ecommerce">GA4 é›»å•†äº‹ä»¶åƒè€ƒ</a></strong></li>
<li><strong><a href="https://developers.facebook.com/docs/meta-pixel/reference">Facebook Pixel åƒè€ƒæ–‡ä»¶</a></strong></li>
<li><strong><a href="https://vuejs.org/guide/essentials/lifecycle.html">Vue.js ç”Ÿå‘½é€±æœŸæŒ‡å—</a></strong></li>
</ul>
<h3 id="%E6%B8%AC%E8%A9%A6%E5%B7%A5%E5%85%B7">æ¸¬è©¦å·¥å…·</h3>
<ul>
<li><strong><a href="https://tagmanager.google.com/">GTM Preview Mode</a></strong></li>
<li><strong><a href="https://chrome.google.com/webstore/detail/facebook-pixel-helper/fdgfkebogiimcoedlicjlajpkdmockpc">Facebook Pixel Helper</a></strong></li>
<li><strong><a href="https://analytics.google.com/">GA4 Real-time å ±å‘Š</a></strong></li>
<li><strong><a href="https://chrome.google.com/webstore/detail/tag-assistant-legacy-by/kejbdjndbnbjgmefkgdddjlbokphdefk">Tag Assistant Legacy</a></strong></li>
</ul>
<h3 id="%E5%AD%B8%E7%BF%92%E8%B3%87%E6%BA%90">å­¸ç¿’è³‡æº</h3>
<ul>
<li><strong><a href="https://analytics.google.com/analytics/academy/">Google Analytics Academy</a></strong></li>
<li><strong><a href="https://www.facebookblueprint.com/">Facebook Blueprint</a></strong></li>
<li><strong><a href="https://support.google.com/tagmanager/answer/6107163">GTM æœ€ä½³å¯¦å‹™æŒ‡å—</a></strong></li>
</ul>
<h3 id="%E5%90%88%E8%A6%8F%E5%B7%A5%E5%85%B7">åˆè¦å·¥å…·</h3>
<ul>
<li><strong><a href="https://developers.google.com/tag-platform/security/consent-mode">Google Consent Mode</a></strong></li>
<li><strong><a href="https://developers.facebook.com/docs/meta-pixel/advanced/advanced-matching">Facebook Advanced Matching</a></strong></li>
<li><strong><a href="https://gdpr.eu/checklist/">GDPR åˆè¦æª¢æŸ¥æ¸…å–®</a></strong></li>
</ul>
<hr>
<p><em>æ­¤æ–‡ä»¶åŸºæ–¼ Vue.js 3 + Pinia + Vue Router çš„é›»å•†å°ˆæ¡ˆæ¶æ§‹ç·¨å¯«</em></p>

</body>
</html>
