<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>台灣線上9R櫻桃(1公斤)比價神器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals (Background: #FDFBF6, Primary Text: #3C2A21, Accent: #E8A374, Chart-Primary: #D4A59A, Chart-Secondary: #A39171) -->
    <!-- Application Structure Plan: The application is designed as an interactive dashboard, diverging from the report's linear format. The structure prioritizes immediate user value and effortless exploration. It begins with "Top Picks" for quick answers, followed by the core "Interactive Comparison Tool" (stacked bar chart + sortable table) to allow deep data exploration. This is supplemented by "Smart Shopper Tips" to provide actionable advice derived from the report's qualitative sections. This task-oriented, dashboard structure was chosen because it directly addresses the user's primary goal: to quickly and easily find the best deal based on their own criteria (total price, speed, etc.), rather than reading a report sequentially. -->
    <!-- Visualization & Content Choices: 
        1.  Report Info: Overall price comparison. -> Goal: Compare total cost composition. -> Viz: Stacked Horizontal Bar Chart (Chart.js/Canvas). -> Interaction: Hover tooltips show price/shipping breakdown. -> Justification: Visually reinforces the report's key message that total cost is a sum of product price and shipping. Horizontal format is ideal for comparing categories.
        2.  Report Info: Full data table. -> Goal: Allow detailed comparison and sorting. -> Presentation: Interactive HTML Table. -> Interaction: Sort buttons (Total Price, Product Price, Shipping) re-order both the chart and the table. -> Justification: Empowers users to analyze data based on their personal priorities, making the data actionable.
        3.  Report Info: Recommendations & purchasing advice. -> Goal: Provide quick, scannable insights. -> Presentation: Styled "Top Picks" and "Tips" cards (HTML/Tailwind). -> Interaction: Static, for easy reading. -> Justification: Distills key qualitative findings into a highly digestible format, enhancing user decision-making.
        Library/Method: Chart.js for canvas-based charts, Vanilla JS for state management and DOM manipulation, Tailwind CSS for styling. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #FDFBF6;
            color: #3C2A21;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
            height: 500px;
            max-height: 70vh;
        }
        @media (max-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .tooltip-custom {
            background-color: rgba(60, 42, 33, 0.9);
            border-radius: 0.5rem;
            color: #FDFBF6;
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
        }
        .active-sort-btn {
            background-color: #3C2A21;
            color: #FDFBF6;
        }
        .inactive-sort-btn {
            background-color: #E8A374;
            color: #3C2A21;
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto px-4 py-8 md:py-12">

        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-[#3C2A21] mb-2">台灣線上9R櫻桃(1公斤)比價神器</h1>
            <p class="text-md text-[#A39171]">根據公開市場報告，為您即時分析最佳購買選擇</p>
        </header>

        <main>
            <section id="recommendations" class="mb-12">
                <h2 class="text-2xl font-bold text-center mb-6">� 本週精選推薦</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white/70 p-6 rounded-lg shadow-md border border-gray-200 text-center">
                        <div class="text-4xl mb-3">🥇</div>
                        <h3 class="font-bold text-xl mb-2">總價最優</h3>
                        <p class="text-2xl font-bold text-[#D4A59A] mb-2">NT$ 650</p>
                        <p class="font-semibold">家樂福線上購物</p>
                        <p class="text-sm text-[#A39171]">(商品 $550 + 運費 $100)</p>
                    </div>
                    <div class="bg-white/70 p-6 rounded-lg shadow-md border border-gray-200 text-center">
                        <div class="text-4xl mb-3">🥈</div>
                        <h3 class="font-bold text-xl mb-2">人氣次選</h3>
                        <p class="text-2xl font-bold text-[#D4A59A] mb-2">NT$ 709</p>
                        <p class="font-semibold">momo購物網 (甜露露)</p>
                        <p class="text-sm text-[#A39171]">(商品 $589 + 運費 $120)</p>
                    </div>
                    <div class="bg-white/70 p-6 rounded-lg shadow-md border border-gray-200 text-center">
                        <div class="text-4xl mb-3">🚀</div>
                        <h3 class="font-bold text-xl mb-2">急速到貨</h3>
                        <p class="text-2xl font-bold text-[#D4A59A] mb-2">NT$ 799</p>
                        <p class="font-semibold">i3Fresh愛上新鮮</p>
                        <p class="text-sm text-[#A39171]">(商品 $799 + 免運費)</p>
                    </div>
                </div>
            </section>

            <section id="comparison-tool" class="mb-12 bg-white/50 p-4 sm:p-6 rounded-xl shadow-lg">
                <h2 class="text-2xl font-bold text-center mb-2">互動比價圖表</h2>
                <p class="text-center text-[#A39171] mb-6">點擊按鈕排序，將滑鼠移至圖表上查看詳細資訊</p>

                <div class="flex justify-center items-center space-x-2 sm:space-x-4 mb-6">
                    <button id="sortByTotalPrice" class="sort-btn text-sm sm:text-base font-semibold py-2 px-4 rounded-full shadow transition-transform transform hover:scale-105">總價排序</button>
                    <button id="sortByProductPrice" class="sort-btn text-sm sm:text-base font-semibold py-2 px-4 rounded-full shadow transition-transform transform hover:scale-105">商品價排序</button>
                    <button id="sortByShipping" class="sort-btn text-sm sm:text-base font-semibold py-2 px-4 rounded-full shadow transition-transform transform hover:scale-105">運費排序</button>
                </div>
                
                <div class="chart-container">
                    <canvas id="priceChart"></canvas>
                </div>
            </section>

            <section id="details-table" class="mb-12">
                 <h2 class="text-2xl font-bold text-center mb-6">詳細價格清單</h2>
                <div class="overflow-x-auto bg-white/50 p-2 sm:p-4 rounded-xl shadow-lg">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50/50">
                            <tr>
                                <th class="px-4 py-3 text-left text-xs font-bold text-[#A39171] uppercase tracking-wider">平台</th>
                                <th class="px-4 py-3 text-left text-xs font-bold text-[#A39171] uppercase tracking-wider">商品價格</th>
                                <th class="px-4 py-3 text-left text-xs font-bold text-[#A39171] uppercase tracking-wider">運費</th>
                                <th class="px-4 py-3 text-left text-xs font-bold text-[#A39171] uppercase tracking-wider">總價</th>
                                <th class="px-4 py-3 text-left text-xs font-bold text-[#A39171] uppercase tracking-wider hidden md:table-cell">備註</th>
                                <th class="px-4 py-3 text-left text-xs font-bold text-[#A39171] uppercase tracking-wider">狀態</th>
                            </tr>
                        </thead>
                        <tbody id="priceTableBody" class="bg-white divide-y divide-gray-200">
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="tips">
                <h2 class="text-2xl font-bold text-center mb-6">💡 精明購物貼士</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="bg-white/70 p-6 rounded-lg shadow-md border border-gray-200">
                        <h3 class="font-bold text-lg mb-2">🛒 善用「湊單」策略</h3>
                        <p class="text-sm text-[#3C2A21]">若單買櫻桃未達免運門檻，可加購其他日常用品，一次購足省下運費，有效降低總成本。</p>
                    </div>
                    <div class="bg-white/70 p-6 rounded-lg shadow-md border border-gray-200">
                        <h3 class="font-bold text-lg mb-2">⚖️ 核對「淨重」與規格</h3>
                        <p class="text-sm text-[#3C2A21]">購買前務必確認商品標示為「淨重」或「含盒重」，並留意重量可能有 ±10% 的合理誤差。</p>
                    </div>
                    <div class="bg-white/70 p-6 rounded-lg shadow-md border border-gray-200">
                        <h3 class="font-bold text-lg mb-2">✔️ 確認「庫存」與運送</h3>
                        <p class="text-sm text-[#3C2A21]">熱門商品易售罄或為「地區限定」。下單前請確認庫存狀態與您的收件地址是否在配送範圍內。</p>
                    </div>
                    <div class="bg-white/70 p-6 rounded-lg shadow-md border border-gray-200">
                        <h3 class="font-bold text-lg mb-2">📦 開箱立即檢查</h3>
                        <p class="text-sm text-[#3C2A21]">生鮮水果不適用7天鑑賞期。收到後請立即開箱檢查，若有問題請馬上拍照並聯繫客服處理。</p>
                    </div>
                </div>
            </section>

        </main>

        <footer class="text-center mt-12 text-[#A39171] text-sm">
            <p>資料來源為公開市場研究報告，價格與庫存狀況可能隨時變動，請以各平台最終結帳頁面為準。</p>
            <p>此工具僅供參考，不構成任何購買建議。</p>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const cherryData = [
                { platform: '家樂福線上購物', product: 'Cherries (9R禮盒)', price: 550, shipping: 100, note: '訂單<800元運費100元', status: '有貨', available: true },
                { platform: 'momo購物網', product: '【甜露露】華盛頓9.5R櫻桃', price: 589, shipping: 120, note: '訂單<800元運費120元', status: '有貨', available: true },
                { platform: 'momo購物網', product: '【櫻桃女王】華盛頓9.5R手摘櫻桃', price: 615, shipping: 120, note: '訂單<800元運費120元', status: '有貨', available: true },
                { platform: 'momo購物網', product: '【RealShop】空運華盛頓9R櫻桃', price: 638, shipping: 120, note: '訂單<800元運費120元', status: '有貨', available: true },
                { platform: 'i3Fresh愛上新鮮', product: '美國9ROW華盛頓櫻桃', price: 799, shipping: 0, note: '1盒免運', status: '有貨', available: true },
                { platform: 'Yahoo購物中心', product: '愛蜜果美國空運櫻桃禮盒9R', price: 750, shipping: null, note: '運費未明確', status: '有貨', available: true },
                { platform: '蝦皮購物', product: '美國華盛頓一公斤空運櫻桃9R', price: 850, shipping: null, note: '運費未明確', status: '有貨', available: true },
                { platform: '鮮盒市集', product: '美國櫻桃9R(禮盒1公斤裝)', price: 850, shipping: null, note: '運費未明確', status: '有貨', available: true },
                { platform: '東森購物網', product: '切果季-美國櫻桃9R', price: 990, shipping: 80, note: '快倉超取<490元運費80元', status: '有貨', available: true },
                { platform: '台灣好農', product: '9R華盛頓櫻桃', price: 1199, shipping: 0, note: '免運費', status: '有貨', available: true },
                { platform: '蝦皮購物', product: '桃園限定華盛頓櫻桃9.5ROW', price: 600, shipping: 0, note: '桃園區/大竹區直送', status: '銷售一空', available: false },
            ].map(item => ({...item, total: item.price + (item.shipping ?? 0) }));

            let currentSort = 'total';
            let chartInstance = null;
            const ctx = document.getElementById('priceChart').getContext('2d');

            const sortButtons = {
                total: document.getElementById('sortByTotalPrice'),
                price: document.getElementById('sortByProductPrice'),
                shipping: document.getElementById('sortByShipping'),
            };

            function updateSortButtons() {
                Object.values(sortButtons).forEach(btn => {
                    btn.classList.remove('active-sort-btn', 'inactive-sort-btn');
                });
                sortButtons.total.classList.add(currentSort === 'total' ? 'active-sort-btn' : 'inactive-sort-btn');
                sortButtons.price.classList.add(currentSort === 'price' ? 'active-sort-btn' : 'inactive-sort-btn');
                sortButtons.shipping.classList.add(currentSort === 'shipping' ? 'active-sort-btn' : 'inactive-sort-btn');
            }

            function sortData() {
                cherryData.sort((a, b) => {
                    if (a.shipping === null) return 1;
                    if (b.shipping === null) return -1;
                    if (!a.available) return 1;
                    if (!b.available) return -1;
                    
                    if (currentSort === 'shipping') {
                         if ((b.shipping ?? Infinity) > (a.shipping ?? Infinity)) return -1;
                         if ((b.shipping ?? Infinity) < (a.shipping ?? Infinity)) return 1;
                    }
                    
                    return a[currentSort] - b[currentSort];
                });
            }

            function renderTable() {
                const tableBody = document.getElementById('priceTableBody');
                tableBody.innerHTML = '';
                cherryData.forEach(item => {
                    const row = document.createElement('tr');
                    const statusColor = item.available ? 'text-green-600' : 'text-red-600';
                    const shippingText = item.shipping === null ? '?' : `NT$ ${item.shipping}`;
                    row.innerHTML = `
                        <td class="px-4 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-[#3C2A21]">${item.platform}</div>
                            <div class="text-xs text-[#A39171]">${item.product}</div>
                        </td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm text-[#3C2A21]">NT$ ${item.price}</td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm text-[#3C2A21]">${shippingText}</td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm font-bold text-[#D4A59A]">NT$ ${item.total}</td>
                        <td class="px-4 py-4 whitespace-nowrap text-xs text-[#A39171] hidden md:table-cell">${item.note}</td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm font-semibold ${statusColor}">${item.status}</td>
                    `;
                    tableBody.appendChild(row);
                });
            }

            function renderChart() {
                if (chartInstance) {
                    chartInstance.destroy();
                }
                
                const filteredData = cherryData.filter(d => d.available && d.shipping !== null);

                chartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: filteredData.map(d => `${d.platform} (${d.product.split('】')[1] || d.product})`),
                        datasets: [{
                            label: '商品價格',
                            data: filteredData.map(d => d.price),
                            backgroundColor: '#D4A59A',
                            borderColor: '#C89387',
                            borderWidth: 1
                        }, {
                            label: '運費',
                            data: filteredData.map(d => d.shipping),
                            backgroundColor: '#A39171',
                            borderColor: '#8E7E60',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                stacked: true,
                                title: {
                                    display: true,
                                    text: '總價格 (NT$)',
                                    font: { size: 14 }
                                }
                            },
                            y: {
                                stacked: true,
                                ticks: {
                                    autoSkip: false,
                                    font: { size: 10 }
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'top',
                            },
                            tooltip: {
                                enabled: false,
                                external: function(context) {
                                    let tooltipEl = document.getElementById('chartjs-tooltip');
                                    if (!tooltipEl) {
                                        tooltipEl = document.createElement('div');
                                        tooltipEl.id = 'chartjs-tooltip';
                                        tooltipEl.className = 'tooltip-custom';
                                        document.body.appendChild(tooltipEl);
                                    }

                                    const tooltipModel = context.tooltip;
                                    if (tooltipModel.opacity === 0) {
                                        tooltipEl.style.opacity = 0;
                                        return;
                                    }

                                    if (tooltipModel.body) {
                                        const dataPoint = filteredData[tooltipModel.dataPoints[0].dataIndex];
                                        const title = tooltipModel.title[0] || '';
                                        let innerHtml = `<div class="font-bold mb-1">${title}</div>`;
                                        innerHtml += `<div>商品: NT$ ${dataPoint.price}</div>`;
                                        innerHtml += `<div>運費: NT$ ${dataPoint.shipping}</div>`;
                                        innerHtml += `<div class="font-bold mt-1 border-t border-gray-400 pt-1">總價: NT$ ${dataPoint.total}</div>`;
                                        tooltipEl.innerHTML = innerHtml;
                                    }

                                    const position = context.chart.canvas.getBoundingClientRect();
                                    tooltipEl.style.opacity = 1;
                                    tooltipEl.style.position = 'absolute';
                                    tooltipEl.style.left = position.left + window.pageXOffset + tooltipModel.caretX + 'px';
                                    tooltipEl.style.top = position.top + window.pageYOffset + tooltipModel.caretY + 'px';
                                    tooltipEl.style.pointerEvents = 'none';
                                }
                            }
                        }
                    }
                });
            }

            function updateUI() {
                sortData();
                renderTable();
                renderChart();
                updateSortButtons();
            }

            sortButtons.total.addEventListener('click', () => {
                currentSort = 'total';
                updateUI();
            });
            sortButtons.price.addEventListener('click', () => {
                currentSort = 'price';
                updateUI();
            });
            sortButtons.shipping.addEventListener('click', () => {
                currentSort = 'shipping';
                updateUI();
            });

            updateUI();
        });
    </script>
</body>
</html>
�